<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lazybones Kill PLAN</title>
  <subtitle>In me the tiger sniffs the rose</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://vrast.cn/"/>
  <updated>2017-03-13T05:07:17.000Z</updated>
  <id>http://vrast.cn/</id>
  
  <author>
    <name>keyle xiao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>关于外语学习</title>
    <link href="http://vrast.cn/posts/44494be0/"/>
    <id>http://vrast.cn/posts/44494be0/</id>
    <published>2017-03-11T13:55:53.000Z</published>
    <updated>2017-03-13T05:07:17.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>我在YouTube的频道上看了一个关于英语的讲座，对我来说有一些感触。我在这里记录下来<br><a href="https://www.youtube.com/watch?v=BENA8QSPmLY" target="_blank" rel="external">视频连接如下</a></p>
</blockquote>
<a id="more"></a>
<h1 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h1><ol>
<li>下意识学习语言需要沟通</li>
<li>靠阅读练习听力是失败的</li>
<li>学东西不能熬夜需要休息</li>
<li>学外语是生理训练的过程</li>
<li>兴奋快乐好奇学的比较快</li>
<li>从跟你有关联的内容开始</li>
<li>把外语当成工具每天说用</li>
</ol>
<h1 id="行动"><a href="#行动" class="headerlink" title="行动"></a>行动</h1><ol>
<li>大量去听是基本功</li>
<li>练好语感(泡脑子，节奏 旋律)</li>
<li>学会外语思维</li>
<li>泡脑子，节奏 旋律</li>
<li>先窄后宽,听到能猜到下句为止。</li>
<li>身体语言(不同的地域有差异)</li>
<li>注意力放在核心</li>
<li>混合已经会的词汇去用</li>
<li>语言家长</li>
<li>模仿面部</li>
<li>外语声音直接连接到心目中的画面</li>
</ol>
<h1 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h1><p>合理的态度，要求和母语相比不要太苛刻</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;我在YouTube的频道上看了一个关于英语的讲座，对我来说有一些感触。我在这里记录下来&lt;br&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=BENA8QSPmLY&quot;&gt;视频连接如下&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="生活" scheme="http://vrast.cn/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="English" scheme="http://vrast.cn/tags/English/"/>
    
  </entry>
  
  <entry>
    <title>关于学习,工作与生活</title>
    <link href="http://vrast.cn/posts/b0ffa5e0/"/>
    <id>http://vrast.cn/posts/b0ffa5e0/</id>
    <published>2017-03-11T13:33:38.000Z</published>
    <updated>2017-03-11T14:52:24.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>近期我的生活看似有规律实则一团乱麻。需要做的事情我也正在做，需要达成的目标也正在继续中。</p>
</blockquote>
<a id="more"></a>
<h1 id="关于今天上课我所遇到的问题，我做了如下的总结"><a href="#关于今天上课我所遇到的问题，我做了如下的总结" class="headerlink" title="关于今天上课我所遇到的问题，我做了如下的总结"></a>关于今天上课我所遇到的问题，我做了如下的总结</h1><p>3月11日。今天早上上听力课，发现自己不懂的句子真的很多，发现了，原来不是那么容易。下午则上高综又被语法和单词形态碾压一边。有点头疼。关于原因我自身反省了一下，我自身认为有以下几点我确实有问题：</p>
<ol>
<li>没有做课前预习</li>
<li>词汇量积累不够</li>
<li>语法懂得少</li>
<li>过于注重平时的训练，没有把上课的事情放在心上</li>
</ol>
<p>回忆今天上课过程中的问题：</p>
<ol>
<li>注意力没集中</li>
<li>没有带笔，全部依赖电脑记录</li>
</ol>
<h1 id="规避上面的问题"><a href="#规避上面的问题" class="headerlink" title="规避上面的问题"></a>规避上面的问题</h1><ol>
<li>预习课本，现在上课的压力并不大，两本书各一个unit</li>
<li>准备纸和笔</li>
<li>做好每日学习计划</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;近期我的生活看似有规律实则一团乱麻。需要做的事情我也正在做，需要达成的目标也正在继续中。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="生活" scheme="http://vrast.cn/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="计划与时间管理" scheme="http://vrast.cn/tags/%E8%AE%A1%E5%88%92%E4%B8%8E%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Use COCOAPODS in XCode</title>
    <link href="http://vrast.cn/posts/6fc31101/"/>
    <id>http://vrast.cn/posts/6fc31101/</id>
    <published>2017-03-09T09:15:01.000Z</published>
    <updated>2017-03-09T10:17:00.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>以前常用VS的 Nuget管理项目的外部类库与一些小插件。在xocde里有类似的东西，它就是Cocopods。</p>
</blockquote>
<a id="more"></a>
<h1 id="如何安装Cocopods"><a href="#如何安装Cocopods" class="headerlink" title="如何安装Cocopods"></a>如何安装Cocopods</h1><p><a href="https://vrast.cn/posts/35d56e26/">MACOS开发环境配置</a></p>
<h1 id="Get-Start"><a href="#Get-Start" class="headerlink" title="Get Start"></a>Get Start</h1><p><a href="https://cocoapods.org" target="_blank" rel="external">原文直接来自官网</a></p>
<p>上面的内容是在pods里搜索，在xcode的项目目录的一个叫<code>Podfile</code>的文件中列出依赖项<br>Search for pods (above). Then list the dependencies in a text file named Podfile in your Xcode project directory:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">platform :ios, <span class="string">'8.0'</span></div><div class="line">use_frameworks!</div><div class="line"></div><div class="line">target <span class="string">'MyApp'</span> <span class="keyword">do</span></div><div class="line">  pod <span class="string">'AFNetworking'</span>, <span class="string">'~&gt; 2.6'</span></div><div class="line">  pod <span class="string">'ORStackView'</span>, <span class="string">'~&gt; 3.0'</span></div><div class="line">  pod <span class="string">'SwiftyJSON'</span>, <span class="string">'~&gt; 2.3'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>提示：CocoaPods提供了一个<code>pod init</code>命令来创建一个灵活的默认<code>Podfile</code>，你会用到它的。<br>Tip: CocoaPods provides a pod init command to create a Podfile with smart defaults. You should use it.</p>
<p>现在你可以在项目里安装依赖项了<br>Now you can install the dependencies in your project:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ pod install</div></pre></td></tr></table></figure>
<p>确保在构建项目时始终打开Xcode工作区(xcworkspace文件)而不是项目文件：<br>Make sure to always open the Xcode workspace instead of the project file when building your project:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ open App.xcworkspace</div></pre></td></tr></table></figure>
<p>现在您可以导入依赖关系，例如：<br>Now you can import your dependencies e.g.:<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Reachability/Reachability.h&gt;</span></span></div></pre></td></tr></table></figure></p>
<h1 id="基础命令"><a href="#基础命令" class="headerlink" title="基础命令"></a>基础命令</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">Usage:</div><div class="line"></div><div class="line">    $ pod COMMAND</div><div class="line"></div><div class="line">      CocoaPods, the Cocoa library package manager.</div><div class="line"></div><div class="line">Commands:</div><div class="line"></div><div class="line">    + <span class="keyword">cache</span>      Manipulate the CocoaPods <span class="keyword">cache</span></div><div class="line">    + env        Display pod environment</div><div class="line">    + init       Generate a Podfile <span class="keyword">for</span> the <span class="keyword">current</span> <span class="keyword">directory</span></div><div class="line">    + <span class="keyword">install</span>    <span class="keyword">Install</span> <span class="keyword">project</span> dependencies according <span class="keyword">to</span> <span class="keyword">versions</span> <span class="keyword">from</span> a</div><div class="line">                 Podfile.lock</div><div class="line">    + ipc        Inter-process communication</div><div class="line">    + lib        Develop pods</div><div class="line">    + <span class="keyword">list</span>       <span class="keyword">List</span> pods</div><div class="line">    + outdated   <span class="keyword">Show</span> outdated <span class="keyword">project</span> dependencies</div><div class="line">    + repo       Manage spec-repositories</div><div class="line">    + setup      Setup the CocoaPods environment</div><div class="line">    + spec       Manage pod specs</div><div class="line">    + <span class="keyword">update</span>     <span class="keyword">Update</span> outdated <span class="keyword">project</span> dependencies <span class="keyword">and</span> <span class="keyword">create</span> <span class="keyword">new</span></div><div class="line">                 Podfile.lock</div><div class="line"></div><div class="line">Options:</div><div class="line"></div><div class="line">    <span class="comment">--silent     Show nothing</span></div><div class="line">    <span class="comment">--version    Show the version of the tool</span></div><div class="line">    <span class="comment">--verbose    Show more debugging information</span></div><div class="line">    <span class="comment">--no-ansi    Show output without ANSI codes</span></div><div class="line">    <span class="comment">--help       Show help banner of specified command</span></div><div class="line">	<span class="keyword">from</span> /<span class="keyword">Library</span>/Ruby/Gems/<span class="number">2.0</span><span class="number">.0</span>/gems/cocoapods<span class="number">-1.2</span><span class="number">.0</span>/lib/cocoapods/command.rb:<span class="number">47</span>:<span class="keyword">in</span> <span class="string">`run'</span></div><div class="line">	from /Library/Ruby/Gems/2.0.0/gems/cocoapods-1.2.0/bin/pod:55:in `&lt;top (<span class="keyword">required</span>)&gt;<span class="string">'</span></div><div class="line">	from /usr/local/bin/pod:23:in `load'</div><div class="line">	<span class="keyword">from</span> /usr/<span class="keyword">local</span>/<span class="keyword">bin</span>/pod:<span class="number">23</span>:<span class="keyword">in</span> <span class="string">`&lt;main&gt;'</span></div></pre></td></tr></table></figure>
<h1 id="为自己的开源项目添加pod支持"><a href="#为自己的开源项目添加pod支持" class="headerlink" title="为自己的开源项目添加pod支持"></a>为自己的开源项目添加pod支持</h1><p><a href="http://www.jianshu.com/p/d7d1942dd3f1" target="_blank" rel="external">iOS开发– 创建podspec文件，为自己的项目添加pod支持</a></p>
<h1 id="Setup报错"><a href="#Setup报错" class="headerlink" title="Setup报错"></a>Setup报错</h1><figure class="highlight tcl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git config --<span class="keyword">global</span> <span class="keyword">http</span>.postBuffer <span class="number">24288000</span></div><div class="line">$ git config --<span class="keyword">list</span></div></pre></td></tr></table></figure>
<p>若输出 http.postbuffer=24288000, 就 OK了</p>
<p><a href="http://blog.csdn.net/wangyanchang21/article/details/51437934" target="_blank" rel="external">cocoapods:常见错误总结</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;以前常用VS的 Nuget管理项目的外部类库与一些小插件。在xocde里有类似的东西，它就是Cocopods。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://vrast.cn/categories/iOS/"/>
    
    
      <category term="Cocopods" scheme="http://vrast.cn/tags/Cocopods/"/>
    
  </entry>
  
  <entry>
    <title>Foundation framework in iOS</title>
    <link href="http://vrast.cn/posts/1e092c72/"/>
    <id>http://vrast.cn/posts/1e092c72/</id>
    <published>2017-03-08T03:29:55.000Z</published>
    <updated>2017-03-08T09:55:55.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>objective-c不像CSharpe有一个标准库 他的标准有很多,想象一下33年前的编程语言 他都经历了什么，因为早期objective-c的一套工具库是乔老头子出走时Next-step公司写的，后来回苹果之后接着维护了。bjective-c一般常用的就是 Foundation framework。这里稍微介绍一些基础工具类。点到即止 API 太多了，我也没时间花大篇幅翻译。用到哪儿就找哪儿的API。<a href="https://developer.apple.com" target="_blank" rel="external">https://developer.apple.com</a> </p>
</blockquote>
<a id="more"></a>
<h1 id="NSString-amp-NSMutableString"><a href="#NSString-amp-NSMutableString" class="headerlink" title="NSString &amp; NSMutableString"></a>NSString &amp; NSMutableString</h1><p>NSString是不可变的，NSMutbaleString是可变的。二者在类型上是不同的，但是存储的字符串是可以做对比的。<br>NSMutbaleString就有点类似C#的StringBuild这个类，可以做一些字符串的增删改操作。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    <span class="built_in">NSMutableString</span>* content1 =[[<span class="built_in">NSMutableString</span> alloc] initWithString:<span class="string">@"hello"</span>];</div><div class="line">    <span class="built_in">NSString</span>* content2 = <span class="string">@"hello"</span>;</div><div class="line">    </div><div class="line">    <span class="built_in">NSMutableString</span>* content3 = <span class="string">@"hello"</span>;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span>(content1 == content2)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"true1"</span>);</div><div class="line">    &#125;<span class="keyword">else</span>&#123; <span class="built_in">NSLog</span>(<span class="string">@"false1"</span>);&#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span>([content1 isEqualToString:content2])</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"true2"</span>);</div><div class="line">    &#125;<span class="keyword">else</span>&#123; <span class="built_in">NSLog</span>(<span class="string">@"false2"</span>);&#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span>(content2 == content3)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"true3"</span>);</div><div class="line">    &#125;<span class="keyword">else</span>&#123; <span class="built_in">NSLog</span>(<span class="string">@"false3"</span>);&#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">11</span>:<span class="number">50</span>:<span class="number">10.983555</span> oc[<span class="number">21186</span>:<span class="number">821911</span>] false1</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">11</span>:<span class="number">50</span>:<span class="number">10.983740</span> oc[<span class="number">21186</span>:<span class="number">821911</span>] true2</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">11</span>:<span class="number">50</span>:<span class="number">10.983756</span> oc[<span class="number">21186</span>:<span class="number">821911</span>] true3</div><div class="line">Program ended with exit code: <span class="number">0</span></div></pre></td></tr></table></figure>
<p><a href="http://www.cocoachina.com/ios/20150724/12722.html" target="_blank" rel="external">NSString&amp;NSMutableString常用操作梳理 - 来自CocoaChina</a></p>
<h1 id="NSArray-amp-NSMutableArray"><a href="#NSArray-amp-NSMutableArray" class="headerlink" title="NSArray &amp; NSMutableArray"></a>NSArray &amp; NSMutableArray</h1><p>和上面的<code>NSString &amp; NSMutableString</code>类似。NSArray是不可变的，NSMutableArray是可变的。二者在类型上是不同的。如果需要操作数组还是用NSMutableString，这个版本的array。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">   </div><div class="line">    <span class="built_in">NSMutableDictionary</span>* ary = [[<span class="built_in">NSMutableDictionary</span> alloc]init];</div><div class="line">    [ary setObject:<span class="string">@"helloworld"</span> forKey:<span class="string">@"123"</span>];</div><div class="line">    [ary setObject:<span class="string">@"helloworld"</span> forKey:<span class="string">@"1233"</span>];</div><div class="line">    [ary removeObjectForKey:<span class="string">@"1233"</span>];</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@ + count %lu"</span>,[ary valueForKey:<span class="string">@"123"</span>],(<span class="keyword">unsigned</span> <span class="keyword">long</span>) ary.count);</div><div class="line">   </div><div class="line">    [ary removeAllObjects];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><a href="http://www.cnblogs.com/qingjoin/archive/2012/09/29/2708117.html" target="_blank" rel="external">NSMutableDictionary 与 NSMutableArray注意的地方 - 来自博客园</a></p>
<h1 id="NSSet"><a href="#NSSet" class="headerlink" title="NSSet"></a>NSSet</h1><p>特点比较明显，无序，不重复。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSSet</span> *set1 = [<span class="built_in">NSSet</span> setWithObjects:<span class="string">@"a"</span>, <span class="string">@"b"</span>, <span class="string">@"c"</span>, <span class="string">@"d"</span>, <span class="literal">nil</span>];</div><div class="line"><span class="built_in">NSSet</span> *set2 = [[<span class="built_in">NSSet</span> alloc] initWithObjects:<span class="string">@"1"</span>, <span class="string">@"2"</span>, <span class="string">@"3"</span>, <span class="literal">nil</span>];</div><div class="line"><span class="built_in">NSArray</span> *array = [<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"a"</span>, <span class="string">@"b"</span>, <span class="string">@"c"</span>, <span class="literal">nil</span>];</div><div class="line"><span class="built_in">NSSet</span> *set3 = [<span class="built_in">NSSet</span> setWithArray:array];</div><div class="line"></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"set1 :%@"</span>, set1);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"set2 :%@"</span>, set2);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"set3 :%@"</span>, set3);</div><div class="line"></div><div class="line"><span class="comment">//获取集合个数</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"set1 count :%d"</span>, set1.count);</div><div class="line"></div><div class="line"><span class="comment">//以数组的形式获取集合中的所有对象</span></div><div class="line"><span class="built_in">NSArray</span> *allObj = [set2 allObjects];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"allObj :%@"</span>, allObj);</div><div class="line"></div><div class="line"><span class="comment">//获取任意一对象</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"anyObj :%@"</span>, [set3 anyObject]);</div><div class="line"></div><div class="line"><span class="comment">//是否包含某个对象</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"contains :%d"</span>, [set3 containsObject:<span class="string">@"obj2"</span>]);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//是否包含指定set中的对象</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"intersect obj :%d"</span>, [set1 intersectsSet:set3]);</div><div class="line"></div><div class="line"><span class="comment">//是否完全匹配</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"isEqual :%d"</span>, [set2 isEqualToSet:set3]);</div><div class="line"></div><div class="line"><span class="comment">//是否是子集合</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"isSubSet :%d"</span>, [set3 isSubsetOfSet:set1]);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">NSSet</span> *set4 = [<span class="built_in">NSSet</span> setWithObjects:<span class="string">@"a"</span>, <span class="string">@"b"</span>, <span class="literal">nil</span>];</div><div class="line"><span class="built_in">NSArray</span> *ary = [<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"1"</span>, <span class="string">@"2"</span>, <span class="string">@"3"</span>, <span class="string">@"4"</span>, <span class="literal">nil</span>];</div><div class="line"><span class="built_in">NSSet</span> *set5 = [set4 setByAddingObjectsFromArray:ary];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"addFromArray :%@"</span>, set5);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">NSMutableSet</span> *mutableSet1 = [<span class="built_in">NSMutableSet</span> setWithObjects:<span class="string">@"1"</span>, <span class="string">@"2"</span>, <span class="string">@"3"</span>, <span class="literal">nil</span>];</div><div class="line"><span class="built_in">NSMutableSet</span> *mutableSet2 = [<span class="built_in">NSMutableSet</span> setWithObjects:<span class="string">@"a"</span>, <span class="string">@"2"</span>, <span class="string">@"b"</span>, <span class="literal">nil</span>];</div><div class="line"><span class="built_in">NSMutableSet</span> *mutableSet3 = [<span class="built_in">NSMutableSet</span> setWithObjects:<span class="string">@"1"</span>, <span class="string">@"c"</span>, <span class="string">@"b"</span>, <span class="literal">nil</span>];</div><div class="line"></div><div class="line"><span class="comment">//集合元素相减</span></div><div class="line">[mutableSet1 minusSet:mutableSet2];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"minus :%@"</span>, mutableSet1);</div><div class="line"></div><div class="line"><span class="comment">//只留下相等元素</span></div><div class="line">[mutableSet1 intersectSet:mutableSet3];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"intersect :%@"</span>, mutableSet1);</div><div class="line"></div><div class="line"><span class="comment">//合并集合</span></div><div class="line">[mutableSet2 unionSet:mutableSet3];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"union :%@"</span>, mutableSet2);</div><div class="line"></div><div class="line"><span class="comment">//删除指定元素</span></div><div class="line">[mutableSet2 removeObject:<span class="string">@"a"</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"removeObj :%@"</span>, mutableSet2);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//删除所有数据</span></div><div class="line">[mutableSet2 removeAllObjects];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"removeAll :%@"</span>, mutableSet2);</div></pre></td></tr></table></figure>
<p>控制台输出：<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.567792</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] set1 :&#123;(</div><div class="line">    d,</div><div class="line">    b,</div><div class="line">    c,</div><div class="line">    a</div><div class="line">)&#125;</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568507</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] set2 :&#123;(</div><div class="line">    <span class="number">1</span>,</div><div class="line">    <span class="number">2</span>,</div><div class="line">    <span class="number">3</span></div><div class="line">)&#125;</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568550</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] set3 :&#123;(</div><div class="line">    a,</div><div class="line">    b,</div><div class="line">    c</div><div class="line">)&#125;</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568570</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] set1 count :<span class="number">4</span></div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568688</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] allObj :(</div><div class="line">    <span class="number">1</span>,</div><div class="line">    <span class="number">2</span>,</div><div class="line">    <span class="number">3</span></div><div class="line">)</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568749</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] anyObj :a</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568773</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] contains :<span class="number">0</span></div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568794</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] intersect obj :<span class="number">1</span></div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568812</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] isEqual :<span class="number">0</span></div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568828</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] isSubSet :<span class="number">1</span></div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568876</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] addFromArray :&#123;(</div><div class="line">    <span class="number">3</span>,</div><div class="line">    b,</div><div class="line">    <span class="number">1</span>,</div><div class="line">    <span class="number">4</span>,</div><div class="line">    <span class="number">2</span>,</div><div class="line">    a</div><div class="line">)&#125;</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568940</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] minus :&#123;(</div><div class="line">    <span class="number">1</span>,</div><div class="line">    <span class="number">3</span></div><div class="line">)&#125;</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.568978</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] intersect :&#123;(</div><div class="line">    <span class="number">1</span></div><div class="line">)&#125;</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.569003</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] <span class="keyword">union</span> :&#123;(</div><div class="line">    b,</div><div class="line">    <span class="number">1</span>,</div><div class="line">    <span class="number">2</span>,</div><div class="line">    a,</div><div class="line">    c</div><div class="line">)&#125;</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.569025</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] removeObj :&#123;(</div><div class="line">    b,</div><div class="line">    <span class="number">1</span>,</div><div class="line">    <span class="number">2</span>,</div><div class="line">    c</div><div class="line">)&#125;</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-08</span> <span class="number">17</span>:<span class="number">08</span>:<span class="number">04.569043</span> oc[<span class="number">49686</span>:<span class="number">2060915</span>] removeAll :&#123;(</div><div class="line">)&#125;</div><div class="line">Program ended with exit code: <span class="number">0</span></div></pre></td></tr></table></figure></p>
<p><a href="http://blog.csdn.net/ms2146/article/details/8657011" target="_blank" rel="external">NSSet使用小结 - 来自CNBLOG</a></p>
<h1 id="NSValue-amp-NSNumber-amp-NSData"><a href="#NSValue-amp-NSNumber-amp-NSData" class="headerlink" title="NSValue &amp; NSNumber &amp; NSData"></a>NSValue &amp; NSNumber &amp; NSData</h1><p>由于集合里只能存放对象，不可以存放基本数据类型,所以我们有时候需要讲一些对象比如基本数据类型，结构体等存到NSDictionary NSArray中，我们就需要将这些数据类型或结构体包装成OC对象，以便集合能访问到。常用的用来包装这些类型的有NSNumber NSValue</p>
<h2 id="NSValue"><a href="#NSValue" class="headerlink" title="NSValue"></a>NSValue</h2><p>NSValue可以包装任意一个对象，包括系统自定义的数据结构，结构体等等</p>
<p>将结构体包装成OC对象:<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGPoint</span> p = <span class="built_in">CGPointMake</span>(<span class="number">1</span>,<span class="number">2</span>);</div><div class="line"><span class="built_in">NSValue</span> *val = [<span class="built_in">NSValue</span> valueWithPoint:p];<span class="comment">//将结构体p包装成NSValue对象</span></div><div class="line"></div><div class="line"><span class="comment">//拆</span></div><div class="line">[value pointValue]</div></pre></td></tr></table></figure></p>
<p><a href="http://www.jianshu.com/p/cb7524567fc5" target="_blank" rel="external">NSNumber 与NSValue -来自简书</a></p>
<h2 id="NSNumber"><a href="#NSNumber" class="headerlink" title="NSNumber"></a>NSNumber</h2><ol>
<li>NSNumber是NSValue的一个子类</li>
<li>NSNumber只能包装基本数据类型，比如int, float,char,BOOL等<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//包装</span></div><div class="line"><span class="keyword">int</span> age = <span class="number">20</span>;</div><div class="line"><span class="built_in">NSNumber</span> *num = [<span class="built_in">NSNumber</span> numberWithInt:age];<span class="comment">//将基本数据类型int对象age 包装成NSNumber对象</span></div><div class="line">@(age);<span class="comment">//直接包装</span></div><div class="line"></div><div class="line"><span class="comment">//拆封</span></div><div class="line">［num intValue］;</div></pre></td></tr></table></figure>
</li>
</ol>
<p><a href="http://www.jianshu.com/p/cb7524567fc5" target="_blank" rel="external">NSNumber 与NSValue -来自简书</a></p>
<h2 id="NSData"><a href="#NSData" class="headerlink" title="NSData"></a>NSData</h2><p><a href="http://www.360doc.com/content/15/0925/09/12282510_501389046.shtml" target="_blank" rel="external">NSData和NSMutableData -来自360doc</a></p>
<p>NSData和NSMutableData存储的是二进制数据，在文件操作，网络，以及核心图形图像中使用较广泛。NSData创建后不可以再修改，NSMutableData可以再次修改。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line">1、NSString和NSData之间的转换</div><div class="line">    NSString *string = @“哎我去上市了！";</div><div class="line">    //1、字符串转换成NSData</div><div class="line">    NSData *data = [string dataUsingEncoding:NSUTF8StringEncoding];</div><div class="line">    //2、NSData转换成字符串</div><div class="line">    NSString * inString = [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];</div><div class="line"></div><div class="line"></div><div class="line"> 2、UIImage和NSData之间的转换</div><div class="line"></div><div class="line"></div><div class="line">    //获取图片路径</div><div class="line">    NSString *imgPath = [[NSBundle mainBundle] pathForResource:@"01loading.png" ofType:nil];</div><div class="line">    NSData *imgData = [NSData dataWithContentsOfFile:imgPath];</div><div class="line">    //直接使用，也可写入文件</div><div class="line">    self.imageView.image = [UIImage imageWithData:imgData];</div><div class="line">     1&gt;.数据库里存储图片 存储图片路径 /images/car@2x.png；</div><div class="line">     2&gt;.如果图片是较小的 可以将UIImage转换成NSData存数据库。</div><div class="line"></div><div class="line"> 3、NSNumber、NSArray、NSDictionary和NSData之间的转换</div><div class="line"> </div><div class="line"></div><div class="line">     数组转NSData是建立在归档的基础上，归档也称为序列化，OC中NSString 对象、NSNumber对象、NSArray对象</div><div class="line">NSDictionary字典对象、NSData 数据对象、这些类要进行数据保存时可以通过NSKeyedArchive 类来实现。</div><div class="line">     Foundtaion框架&lt;Foundation/NSKeyedArchiver.h&gt;提供归档和解归档的方式，也叫做序列化和反序列化的过程。</div><div class="line">     1&gt;.把字典或数组用归档形式直接保存到某一个文件中</div><div class="line">    //初始化一个字典</div><div class="line">    NSDictionary *dict = @&#123;</div><div class="line">                           @"key1":@"hahahah1",</div><div class="line">                           @"key2":@"hahahah2",</div><div class="line">                           @"key3":@"hahahah3",</div><div class="line">                           @"key4":@"hahahah4",</div><div class="line">                           @"key5":@"hahahah5",</div><div class="line">                           @"key6":@"hahahah6",</div><div class="line">                           @"key7":@"hahahah7"&#125;;</div><div class="line">    //归档路径</div><div class="line">    NSString *docPath = [[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) firstObject] stringByAppendingPathComponent:@"dict.plist"];</div><div class="line">    //归档后直接保存到文件中</div><div class="line">    [NSKeyedArchiver archiveRootObject:dict toFile:docPath];</div><div class="line"></div><div class="line">     2&gt;.把字典或数组先转换成NSData，再保存到某一个文件中</div><div class="line">    //初始化一个字典</div><div class="line">    NSDictionary *dict = @&#123;</div><div class="line">                           @"key1":@"hahahah1",</div><div class="line">                           @"key2":@"hahahah2",</div><div class="line">                           @"key3":@"hahahah3",</div><div class="line">                           @"key4":@"hahahah4",</div><div class="line">                           @"key5":@"hahahah5",</div><div class="line">                           @"key6":@"hahahah6",</div><div class="line">                           @"key7":@"hahahah7"&#125;;</div><div class="line">    //归档路径</div><div class="line">    NSString *docPath = [[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) firstObject] stringByAppendingPathComponent:@"dict.plist"];</div><div class="line">    //转换成NSData</div><div class="line">    NSData *dictData = [NSKeyedArchiver archivedDataWithRootObject:dict];</div><div class="line">    //保存到文件中</div><div class="line">    NSFileManager *fm = [NSFileManager defaultManager];</div><div class="line">    [fm createFileAtPath:docPath contents:dictData attributes:nil];</div><div class="line">     3&gt;.解归档</div><div class="line">          直接从文件解归档</div><div class="line">    NSDictionary *Undict = [NSKeyedUnarchiver unarchiveObjectWithFile:docPath];</div><div class="line">     将文件转换成NSData，在从NSData解归档</div><div class="line">    NSData *UndictData = [fm contentsAtPath:docPath];</div><div class="line">    NSDictionary *Undict = [NSKeyedUnarchiver unarchiveObjectWithData:UndictData];</div></pre></td></tr></table></figure>
<h1 id="iO操作"><a href="#iO操作" class="headerlink" title="iO操作"></a>iO操作</h1><p><a href="http://blog.csdn.net/swingpyzf/article/details/15185767" target="_blank" rel="external">Objective-C文件和目录操作,IOS文件操作,NSFileManager使用文件操作 -来自CSDN</a><br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div></pre></td><td class="code"><pre><div class="line">Objective-C文件和目录操作,IOS文件操作,<span class="built_in">NSFileManager</span>使用文件操作:</div><div class="line"></div><div class="line">objective-c通过使用<span class="built_in">NSFileManager</span>类来管理和操作文件、目录，<span class="built_in">NSFileManager</span>,文件或目录是使用文件的路径名的唯一标示。每个路径名都是一个<span class="built_in">NSString</span>对象。</div><div class="line"><span class="built_in">NSFileManager</span>对象通过defaultManager方法来创建实例</div><div class="line">列如：</div><div class="line"><span class="built_in">NSFileManager</span> *fm = [<span class="built_in">NSFileManager</span> defaultManager];</div><div class="line"></div><div class="line">删除某个文件</div><div class="line">[fm removeItemAtPath:<span class="string">@"filename"</span> error:<span class="literal">NULL</span>];</div><div class="line">error:参数是一个指向<span class="built_in">NSError</span>对象的指针，能够提供错误的信息。如果指定为<span class="literal">NULL</span>的话就会使用默认的行为，返回值是<span class="built_in">BOOL</span>类型的方法，操作成功返回<span class="literal">YES</span>反之返回<span class="literal">NO</span></div><div class="line"></div><div class="line">判断文件是否被删除</div><div class="line"><span class="keyword">if</span>([fm removeItemAtPath:<span class="string">@"filename"</span> error:<span class="literal">NULL</span>]==<span class="literal">NO</span>)&#123;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"文件删除失败"</span>);</div><div class="line"><span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">NSFileManager</span>常用的文件方法：</div><div class="line"></div><div class="line">-(<span class="built_in">NSData</span>*)contentsAtPath:path 从一个文件中读取数据</div><div class="line"></div><div class="line">-(BOLL)createFileAtPath:path contents:(<span class="built_in">NSData</span>*)data attributes: attr 向一个文件写入数据</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)removeItemAtPath:path error:err 删除一个文件</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)moveItemAtPath:from toPath:to error:err 重命名或移动一个文件(to 不能是已存在的)</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)copyItemAtPath:from toPath:to error:err 复制文件(to 不能是已存在的)</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)contentsEqualAtPath:path1 andPath:path2 比较这两个文件的内容</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)fileExistsAtPath:path 测试文件是否存在</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)isReadableFileAtPath:path 测试文件是否存在，并且是否能执行读操作</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)isWritableFileAtPath:path 测试文件是否存在，并且是否能执行写操作</div><div class="line"></div><div class="line">-(<span class="built_in">NSDictionary</span>*)attributesOfItemAtPath:path error:err 获取文件的属性</div><div class="line">属性字典允许你指定要创建的文件的权限，如果将该参数指定为<span class="literal">nil</span>，该文件会被设置为默认权限。</div><div class="line"></div><div class="line"><span class="number">1</span>、通过一段程序来对文件进行操作：</div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  main.m</span></div><div class="line"><span class="comment">//  NSFileManager_01</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  Created by swinglife on 13-11-10.</span></div><div class="line"><span class="comment">//  Copyright (c) 2013年 swinglife. All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</div><div class="line">&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        <span class="comment">//文件名</span></div><div class="line">        <span class="built_in">NSString</span> *fileName = <span class="string">@"testFile"</span>;</div><div class="line">        <span class="built_in">NSString</span> *fileContent = <span class="string">@"这是文件内容!!!!"</span>;</div><div class="line">        <span class="built_in">NSData</span> *fileData = [fileContent dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</div><div class="line">        </div><div class="line">        <span class="comment">//创建NSFileManager实例</span></div><div class="line">        <span class="built_in">NSFileManager</span> *fm = [<span class="built_in">NSFileManager</span> defaultManager];</div><div class="line">        </div><div class="line">        <span class="comment">//创建文件</span></div><div class="line">        [fm createFileAtPath:fileName contents:fileData attributes:<span class="literal">nil</span>];</div><div class="line">        </div><div class="line">        <span class="comment">//判断文件是否存在 不存在就结束程序</span></div><div class="line">        <span class="keyword">if</span>([fm fileExistsAtPath:fileName]==<span class="literal">NO</span>)&#123;</div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"文件不存在"</span>);</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">//拷贝文件</span></div><div class="line">        <span class="keyword">if</span>([fm copyItemAtPath:fileName toPath:<span class="string">@"newFile"</span> error:<span class="literal">NULL</span>]==<span class="literal">NO</span>)&#123;</div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"复制失败"</span>);</div><div class="line">            <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">//测试两个文件是否相同</span></div><div class="line">        <span class="keyword">if</span>([fm contentsEqualAtPath:fileName andPath:<span class="string">@"newFile"</span>]==<span class="literal">NO</span>)&#123;</div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"文件不相同"</span>);</div><div class="line">            <span class="keyword">return</span> <span class="number">3</span>;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">//重命名newFile</span></div><div class="line">        [fm moveItemAtPath:<span class="string">@"newFile"</span> toPath:<span class="string">@"newFile2"</span> error:<span class="literal">NULL</span>];</div><div class="line">        </div><div class="line">        <span class="comment">//获取newFile2的大小</span></div><div class="line">        <span class="built_in">NSDictionary</span> *fileAttr = [fm attributesOfItemAtPath:<span class="string">@"newFile2"</span> error:<span class="literal">NULL</span>];</div><div class="line">        <span class="keyword">if</span>(fileAttr!=<span class="literal">nil</span>)&#123;</div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"文件大小:%llu bytes"</span>,[[fileAttr objectForKey:<span class="built_in">NSFileSize</span>] unsignedLongLongValue]);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">//删除文件</span></div><div class="line">        [fm removeItemAtPath:fileName error:<span class="literal">NULL</span>];</div><div class="line">        </div><div class="line">        <span class="comment">//显示newFile2的内容</span></div><div class="line">        <span class="built_in">NSString</span> *data = [<span class="built_in">NSString</span> stringWithContentsOfFile:<span class="string">@"newFile2"</span> encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">NULL</span>];</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,data);</div><div class="line">        </div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">NSFileManager</span>常用的目录方法</div><div class="line"></div><div class="line">-(<span class="built_in">NSString</span>*)currentDirectoryPath 获取当前目录</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)changeCurrentDirectoryPath:path 更改当前目录</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)copyItemAtPath:from toPath:to error:err 复制目录结构</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)createDirectoryAtPath:path withIntermediateDirectories:(<span class="built_in">BOOL</span>)flag attributes:attr 创建一个新目录</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)fileExistsAtPath:path isDirectory:(<span class="built_in">BOOL</span>*)flag 测试文件是不是目录(flag中存储结果)</div><div class="line"></div><div class="line">-(<span class="built_in">NSArray</span>*)contentsOfDirectoryAtPath:path error:err 列出目录内容</div><div class="line"></div><div class="line">-(<span class="built_in">NSDirectoryEnumerator</span>*)enumeratorAtPath:path 枚举目录的内容</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)removeItemAtPath:path error:err 删除空目录</div><div class="line"></div><div class="line">-(<span class="built_in">BOOL</span>)moveItemAtPath:from toPath:to error:err 重命名或移动一个目录</div><div class="line"></div><div class="line"><span class="number">2</span>、通过一段程序来对目录进行操作：</div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  main.m</span></div><div class="line"><span class="comment">//  NSFileManager_02</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  Created by swinglife on 13-11-10.</span></div><div class="line"><span class="comment">//  Copyright (c) 2013年 swinglife. All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[])</div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        <span class="comment">//文件目录</span></div><div class="line">        <span class="built_in">NSString</span> *dirName = <span class="string">@"testDir"</span>;</div><div class="line">        </div><div class="line">        <span class="comment">//创建NSFileManager实例</span></div><div class="line">        <span class="built_in">NSFileManager</span> *fm = [<span class="built_in">NSFileManager</span> defaultManager];</div><div class="line">        </div><div class="line">        <span class="comment">//获取当前目录</span></div><div class="line">        <span class="built_in">NSString</span> *path = [fm currentDirectoryPath];</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Path:%@"</span>,path);</div><div class="line">        </div><div class="line">        <span class="comment">//创建新目录</span></div><div class="line">        [fm createDirectoryAtPath:dirName withIntermediateDirectories:<span class="literal">YES</span> attributes:<span class="literal">nil</span> error:<span class="literal">NULL</span>];</div><div class="line">        </div><div class="line">        <span class="comment">//重命名新的目录</span></div><div class="line">        [fm moveItemAtPath:dirName toPath:<span class="string">@"newDir"</span> error:<span class="literal">NULL</span>];</div><div class="line">        </div><div class="line">        <span class="comment">//更改当前目录到新的目录</span></div><div class="line">        [fm changeCurrentDirectoryPath:<span class="string">@"newDir"</span>];</div><div class="line">        </div><div class="line">        <span class="comment">//获取当前工作目录</span></div><div class="line">        path = [fm currentDirectoryPath];</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Path:%@"</span>,path);</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;objective-c不像CSharpe有一个标准库 他的标准有很多,想象一下33年前的编程语言 他都经历了什么，因为早期objective-c的一套工具库是乔老头子出走时Next-step公司写的，后来回苹果之后接着维护了。bjective-c一般常用的就是 Foundation framework。这里稍微介绍一些基础工具类。点到即止 API 太多了，我也没时间花大篇幅翻译。用到哪儿就找哪儿的API。&lt;a href=&quot;https://developer.apple.com&quot;&gt;https://developer.apple.com&lt;/a&gt; &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://vrast.cn/categories/iOS/"/>
    
    
      <category term="ExcFoundation framework" scheme="http://vrast.cn/tags/ExcFoundation-framework/"/>
    
  </entry>
  
  <entry>
    <title>Exception in iOS</title>
    <link href="http://vrast.cn/posts/372264d9/"/>
    <id>http://vrast.cn/posts/372264d9/</id>
    <published>2017-03-06T08:59:21.000Z</published>
    <updated>2017-03-06T13:23:52.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>每一种语言都有自己的异常处理机制，几乎都类似有一个 Exception 类型，和一个 throw 的动作。</p>
</blockquote>
<a id="more"></a>
<h1 id="使用NSExpection系统"><a href="#使用NSExpection系统" class="headerlink" title="使用NSExpection系统"></a>使用NSExpection系统</h1><p>通过Expection的 exceptionWithName 定义一个异常说明。使用 @throw 抛出这个异常<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    </div><div class="line">    <span class="built_in">NSException</span>* ex =[<span class="built_in">NSException</span> exceptionWithName:<span class="string">@"error happen ..."</span> reason:<span class="string">@"haha.."</span> userInfo:<span class="literal">nil</span>];</div><div class="line">    </div><div class="line">    <span class="keyword">@try</span> &#123;</div><div class="line">        <span class="keyword">@throw</span> ex;</div><div class="line">    &#125; <span class="keyword">@catch</span> (<span class="built_in">NSException</span> *exception) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"catch expection %@"</span>,exception.name);</div><div class="line">    &#125; <span class="keyword">@finally</span> &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"finally ..."</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>控制台输出如下：<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-06</span> <span class="number">17</span>:<span class="number">16</span>:<span class="number">29.790786</span> oc[<span class="number">56297</span>:<span class="number">1862847</span>] catch expection error happen ...</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-06</span> <span class="number">17</span>:<span class="number">16</span>:<span class="number">29.791746</span> oc[<span class="number">56297</span>:<span class="number">1862847</span>] finally ...</div><div class="line">Program ended with exit code: <span class="number">0</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;每一种语言都有自己的异常处理机制，几乎都类似有一个 Exception 类型，和一个 throw 的动作。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://vrast.cn/categories/iOS/"/>
    
    
      <category term="Exception" scheme="http://vrast.cn/tags/Exception/"/>
    
  </entry>
  
  <entry>
    <title>Extension in iOS</title>
    <link href="http://vrast.cn/posts/f84fd914/"/>
    <id>http://vrast.cn/posts/f84fd914/</id>
    <published>2017-03-06T06:43:32.000Z</published>
    <updated>2017-03-06T08:04:59.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>通过扩展类来增强类的扩展性。非常好用的一个增强类功能的方式，可以参考C#的 <code>partial</code> 部分类。<br><a id="more"></a></p>
</blockquote>
<p>下面的例子直接使用扩展类。不修改原类型 <code>Foo</code>的前提下，给  <code>Foo</code> 添加了一个 <code>GetDescription</code> 实例方法。并且访问了 <code>Foo</code> 的 <code>stringOnFoo</code> 属性。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Foo.h"</span></span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Foo</span> (<span class="title">Print</span>)</span></div><div class="line">-(<span class="built_in">NSString</span>*)GetDescription;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Foo</span> (<span class="title">Print</span>)</span></div><div class="line">-(<span class="built_in">NSString</span>*)GetDescription</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.stringOnFoo) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,<span class="keyword">self</span>.stringOnFoo);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.stringOnFoo;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="string">@""</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    </div><div class="line">    Foo* fo = [[Foo alloc]init];</div><div class="line">    fo.stringOnFoo = <span class="string">@"helloworld"</span>;</div><div class="line">    [fo GetDescription];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>扩展类型的时候记得要加上属于自己的前缀，因为在原类型中可能后续会追加与扩展类的重名的方法签名，导致无法调用，即被扩展类的方法覆盖。</p>
<h1 id="匿名类扩展"><a href="#匿名类扩展" class="headerlink" title="匿名类扩展"></a>匿名类扩展</h1><p>我在这里声明了一个匿名的扩展类型。然后在 Foo.m 中进行了实现。这个接口声明对使用者隐藏了。所以也不用 import 这个匿名头文件，可以直接调用。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Foo</span>()</span></div><div class="line">-(<span class="keyword">void</span>)InvokePrivateMethod;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    </div><div class="line">    Foo* fo = [[Foo alloc]init];</div><div class="line">    [fo InvokePrivateMethod];</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;通过扩展类来增强类的扩展性。非常好用的一个增强类功能的方式，可以参考C#的 &lt;code&gt;partial&lt;/code&gt; 部分类。&lt;br&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://vrast.cn/categories/iOS/"/>
    
    
      <category term="Extension" scheme="http://vrast.cn/tags/Extension/"/>
    
  </entry>
  
  <entry>
    <title>Protocal in iOS</title>
    <link href="http://vrast.cn/posts/cdd77a74/"/>
    <id>http://vrast.cn/posts/cdd77a74/</id>
    <published>2017-03-06T02:39:18.000Z</published>
    <updated>2017-03-06T07:43:12.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>记录关于协议在objectivec中的用法以及类比。之前我认为 objectivec 所谓的协议就是C#里的接口。oc里的协议支持继承，支持可选实现，支持嵌套的结构(在A协议使用B协议) 的意思。</p>
</blockquote>
<a id="more"></a>
<h1 id="像c-使用接口那样使用协议"><a href="#像c-使用接口那样使用协议" class="headerlink" title="像c#使用接口那样使用协议"></a>像c#使用接口那样使用协议</h1><p>我创建了一个默认的协议，继承了NSObject的协议，这个协议当然是可选的。不正经的说这里就像是C#的泛型约束(where class)。<br>我在这里标记了 @required ,这也是可选的，因为默认都是 @required。<br>@optional 也是可选的，标记了 @optional 就可以不必在继承此协议的类中使用。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">PrintLine</span></span></div><div class="line"></div><div class="line"><span class="keyword">@required</span></div><div class="line">-(<span class="keyword">void</span>)Log:(<span class="built_in">NSString</span>*) content;</div><div class="line"></div><div class="line"><span class="keyword">@optional</span></div><div class="line">-(<span class="keyword">void</span>)SayHello:(<span class="built_in">NSString</span>*) content;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>可以在尖括号里添加多个协议<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Bar.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"PrintLine.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Foo</span> : <span class="title">NSObject</span>&lt;<span class="title">PrintLine</span>,<span class="title">NSObject</span>&gt;</span></div><div class="line">&#123;</div><div class="line">    Bar* bar;</div><div class="line">    <span class="built_in">NSString</span>* stringOnFoo;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) Bar* bar;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSString</span>* stringOnFoo;</div><div class="line"></div><div class="line">+(<span class="keyword">void</span>)sayHello:(<span class="built_in">NSString</span>*) name;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)addObserver;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure></p>
<p>如果想要知道一个协议是否被正在使用的类实现了，可以使用 <code>confirmsToProtocal</code></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Foo.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"PrintLine.h"</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">     Foo* fo = [[Foo alloc]init];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([fo conformsToProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">PrintLine</span>)]) </span>&#123;</div><div class="line">        [fo Log:<span class="string">@"protocal"</span>];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;记录关于协议在objectivec中的用法以及类比。之前我认为 objectivec 所谓的协议就是C#里的接口。oc里的协议支持继承，支持可选实现，支持嵌套的结构(在A协议使用B协议) 的意思。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://vrast.cn/categories/iOS/"/>
    
    
      <category term="Protocal" scheme="http://vrast.cn/tags/Protocal/"/>
    
  </entry>
  
  <entry>
    <title>English Grammar 1</title>
    <link href="http://vrast.cn/posts/c511b8c1/"/>
    <id>http://vrast.cn/posts/c511b8c1/</id>
    <published>2017-03-04T12:59:48.000Z</published>
    <updated>2017-03-06T07:43:12.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>为什么要学外语 ？如果不感兴趣的你可以不用学，嘿嘿。 本文是我阅读文法俱乐部(旋元佑老师著作)的笔记，无笔记不读书。记录一些关键的信息，一共二十二个章节，我打算分11个笔记记录我阅读的过程。那么我们就开始了 😁</p>
</blockquote>
<a id="more"></a>
<h1 id="五种常见基本句型"><a href="#五种常见基本句型" class="headerlink" title="五种常见基本句型"></a>五种常见基本句型</h1><p>主            动          宾           补<br>S : Subject   V : Verb   O：Object   C: Complement</p>
<ul>
<li>S + V </li>
<li>S + V + O</li>
<li>S + V + C</li>
<li>S + V + O + O</li>
<li>S + V + O + C</li>
</ul>
<p>一个完整的句子少不了动词。</p>
<h1 id="补语"><a href="#补语" class="headerlink" title="补语"></a>补语</h1><p>要了解补语，只需要研究那些解释为“是”的动词。基本句型分五种，是因为有五种特性不同的动词而造成的。<br>在所有的英语动词中，只有解释为“是”的动词是空的,完全没有意义。也只有这种动词才需要补语来补足句子的意思。</p>
<p>可以独立发生，不牵涉到别的人或物，这种动词就叫“不及物”动词。不及物动词反之。</p>
<p>一个完整的句子必须能够表达完整的意思。这需要两个以上部分来完成：主语和动词。主语，是这个句子叙述的对象。动词，构成叙述的主要内容。</p>
<p>在中文翻译中，动词“是”完全不见了！<br>The cat is lovely.        这只猫很可爱。<br>The soup is too hot.      汤太烫了<br>Taroko Gorge is beautiful.xx峡谷很美。</p>
<p>我们称“是”为连缀动词。跟在这种动词后面的部分，因为代替了动词所扮演的叙述角色，补足了句子使它获得完整的意思，称之为“补语”。</p>
<p>需要补语的动词有哪些：<br>look , seem , appear , sound , feel . taste , turn , prove , become , make<br>因为这些动词都是空字眼，都还不能构成一个有意义的完整句子，所以需要补语来补足。<br>上面这些动词有一个特点 就是都可以用 is 来替代。</p>
<blockquote>
<p>检验 <code>S + V + O + C </code>的技巧，把宾语与补语拿出来中间加一个be动词。看看能不能改成 <code>S + V + C</code></p>
</blockquote>
<p>补语的词类应该是名词和形容词比较合理。因为主语或宾语都是名词，所以补语也可以是名词，经由“是”连接表达同等的关系。</p>
<p>be动词时最纯粹的linking verb，解释为“是”，后面应该有补语才算完整，如果看到be动词后面没有补语，表示这个be动词并不是当作连缀动词使用。如果看到be动词后面没有补语，表示这个be动词并不是当作连缀动词使用，这时候be动词不解释为“是”，而是要解释为“存在”，用在最单纯的“主语+动词(S+V)”的句型中。<br>A is B’s father . 这里be动词必须翻译出来。<br>To be or not to be .that is the question. –哈姆雷特</p>
<h1 id="双宾语句型"><a href="#双宾语句型" class="headerlink" title="双宾语句型"></a>双宾语句型</h1><p>dog 并不对 him 进行补充,him 与 dog是并列的，所以都是宾语。可以把两个宾语拿出来中间加一个be 哈哈。him is a dog 。骂人就不对了。<br>A’s father gave him a dog.</p>
<p>dog是对him的补充说明。所以满足 SVOC<br>A’s father called him a dog. </p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;为什么要学外语 ？如果不感兴趣的你可以不用学，嘿嘿。 本文是我阅读文法俱乐部(旋元佑老师著作)的笔记，无笔记不读书。记录一些关键的信息，一共二十二个章节，我打算分11个笔记记录我阅读的过程。那么我们就开始了 😁&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="English" scheme="http://vrast.cn/categories/English/"/>
    
    
      <category term="Grammar" scheme="http://vrast.cn/tags/Grammar/"/>
    
  </entry>
  
  <entry>
    <title>KVO in iOS</title>
    <link href="http://vrast.cn/posts/d0d6deab/"/>
    <id>http://vrast.cn/posts/d0d6deab/</id>
    <published>2017-03-02T11:20:52.000Z</published>
    <updated>2017-03-03T08:07:12.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>如果我更改了一个属性的值，KVO会帮助我们检测这个值的变化，从而通知我们这个值改变了。典型的观察者模式。当然我想起在UNITY3D中，如果检视面板的数值发生改变对应的GameObject发生位移之类的。我曾经实现了一个inspector的编辑器类，值改变直接通知(其实是调用)对应的函数。在iOS这里 一切发生的那么自然。不需要额外实现 这是iOS的特性之一 名曰：KVO 。</p>
</blockquote>
<a id="more"></a>
<h1 id="前情提要"><a href="#前情提要" class="headerlink" title="前情提要"></a>前情提要</h1><p>上一篇 KVC 讲到需要遵循的几条几本规则在 KVO 中同样适用。</p>
<ul>
<li>骆驼命名法,不能数字开头</li>
<li>不能包含空格</li>
<li>键必须是ASCII编码的</li>
<li>使用默认的get/set</li>
</ul>
<p>上一章 只要是针对 object 的元素查询，调用，筛选。本文主要是讲述 KVO 监听(观察者模式) 属性值的变更。</p>
<h1 id="添加／移除-一个监听"><a href="#添加／移除-一个监听" class="headerlink" title="添加／移除 一个监听"></a>添加／移除 一个监听</h1><p>addObserver 函数签名如下</p>
<ul>
<li>addObserver：监听的接受脚本的类</li>
<li>context：    随便传入任何值都可以，最后取出来的时候需要强转</li>
<li>forKeyPath:  选择一个需要监听的属性</li>
<li>options：    可选项</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Foo.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Bar.h"</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    Foo* foo = [[Foo alloc]init];</div><div class="line">    foo.bar = [[Bar alloc]init];</div><div class="line">    [foo.bar addObserver:foo forKeyPath:<span class="string">@"stringOnBar"</span> options:<span class="number">0</span> context: (<span class="keyword">void</span>*)s];</div><div class="line">    </div><div class="line">    foo.bar.stringOnBar = <span class="string">@"test"</span>;</div><div class="line"></div><div class="line">    [foo.bar removeObserver:foo forKeyPath:<span class="string">@"stringOnBar"</span>];</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>控制台输出如下:<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-03</span> <span class="number">15</span>:<span class="number">17</span>:<span class="number">22.085142</span> oc[<span class="number">52721</span>:<span class="number">6279405</span>] helloworld</div><div class="line"><span class="number">2017</span><span class="number">-03</span><span class="number">-03</span> <span class="number">15</span>:<span class="number">17</span>:<span class="number">22.085371</span> oc[<span class="number">52721</span>:<span class="number">6279405</span>] Value Changed : stringOnBar</div><div class="line">Program ended with exit code: <span class="number">0</span></div></pre></td></tr></table></figure></p>
<h2 id="关于-options-可选项"><a href="#关于-options-可选项" class="headerlink" title="关于 options 可选项"></a>关于 options 可选项</h2><p>上面的代码中 options 是个可选项，这里不需要处理所以填写0，详细的选项如下：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSKeyValueObservingOptionNew</span>     把更改之前的值提供给处理方法</div><div class="line"><span class="built_in">NSKeyValueObservingOptionOld</span>     把更改之后的值提供给处理方法</div><div class="line"><span class="built_in">NSKeyValueObservingOptionInitial</span> 把初始化的值提供给处理方法，一旦注册，立马就会调用一次。通常它会带有新值，而不会带有旧值。</div><div class="line"><span class="built_in">NSKeyValueObservingOptionPrior</span>   分<span class="number">2</span>次调用。在值改变之前和值改变之后。</div><div class="line"><span class="number">0</span>                                不带任何参数进去</div></pre></td></tr></table></figure>
<p>传递给监听的值在接受函数<code> ofObject:(id)object </code>可以获取到。</p>
<h2 id="关于监听脚本"><a href="#关于监听脚本" class="headerlink" title="关于监听脚本"></a>关于监听脚本</h2><p>不用担心监听脚本过于复杂。其实是自动生成的 键入 observeValueForKeyPath 则会生成如下代码：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)observeValueForKeyPath:(<span class="built_in">NSString</span> *)keyPath ofObject:(<span class="keyword">id</span>)object change:(<span class="built_in">NSDictionary</span> *)change context:(<span class="keyword">void</span> *)context</div><div class="line">&#123;</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span>* content = (__bridge <span class="built_in">NSString</span>*)context;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (content) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,content);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([keyPath isEqualToString:<span class="string">@"stringOnBar"</span>]) &#123;</div><div class="line">         <span class="built_in">NSLog</span>(<span class="string">@"Value Changed : stringOnBar"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> ([keyPath isEqualToString:<span class="string">@"stringOnFoo"</span>]) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Value Changed : stringOnFoo"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    [<span class="keyword">super</span> observeValueForKeyPath:keyPath ofObject:object change:change context:context];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当然结构体里面的内容是我自己些的 😄</p>
<p>当类 dealloc 的时候需要手动移除监听，否则会报错 … 报错信息如下:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">2017-03-03 15:16:02.560251 oc[52593:6273946] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'An instance 0x1004065e0 of class Bar was deallocated while key value observers were still registered with it. Current observation info: &lt;NSKeyValueObservationInfo 0x100406b90&gt; (</div><div class="line">&lt;NSKeyValueObservance 0x100407e80: Observer: 0x1004045e0, Key path: stringOnBar, Options: &lt;New: NO, Old: NO, Prior: NO&gt; Context: 0x1000030c0, Property: 0x100406ac0&gt;</div><div class="line">)'</div><div class="line">*** First throw call stack:</div><div class="line">(</div><div class="line">	0   CoreFoundation                      0x00007fffa311fe7b __exceptionPreprocess + 171</div><div class="line">	1   libobjc.A.dylib                     0x00007fffb7d09cad objc_exception_throw + 48</div><div class="line">	2   CoreFoundation                      0x00007fffa319e99d +[NSException raise:format:] + 205</div><div class="line">	3   Foundation                          0x00007fffa4aff6e4 NSKVODeallocate + 293</div><div class="line">	4   oc                                  0x000000010000278e -[Foo .cxx_destruct] + 78</div><div class="line">	5   libobjc.A.dylib                     0x00007fffb7d05686 _ZL27object_cxxDestructFromClassP11objc_objectP10objc_class + 127</div><div class="line">	6   libobjc.A.dylib                     0x00007fffb7cfe0c6 objc_destructInstance + 92</div><div class="line">	7   libobjc.A.dylib                     0x00007fffb7cfe059 object_dispose + 22</div><div class="line">	8   oc                                  0x000000010000166e main + 398</div><div class="line">	9   libdyld.dylib                       0x00007fffb85ed255 start + 1</div><div class="line">)</div><div class="line">libc++abi.dylib: terminating with uncaught exception of type NSException</div><div class="line">(lldb)</div></pre></td></tr></table></figure>
<h1 id="手动KVO"><a href="#手动KVO" class="headerlink" title="手动KVO"></a>手动KVO</h1><p>KVO不是万能的，有时候我们在某些条件下不希望接受到KVO的通知，需要重写如下方法:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSInteger</span> HP = <span class="number">10</span>;</div><div class="line">+(<span class="built_in">BOOL</span>)automaticallyNotifiesObserversOfStringOnFoo</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(HP&gt;<span class="number">100</span>)</div><div class="line">      <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>这里有一个技巧输入 <code>+(BOOL)automatically</code> 之后自动列出可以重写的几个属性的通知。</code></p>
<p>手动触发KVO也是允许的,下面主要使用到了 <code>willChangeValueForKey ／ didChangeValueForKey</code> 这两个函数。即使禁止了自动通知也可以直接在get函数中触发。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSInteger</span> HP = <span class="number">11</span>;</div><div class="line"></div><div class="line">+(<span class="built_in">BOOL</span>)automaticallyNotifiesObserversOfStringOnFoo</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(HP&gt;<span class="number">100</span>)</div><div class="line">      <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)setStringOnFoo:(<span class="built_in">NSString</span> *) inValue</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">self</span> willChangeValueForKey:<span class="string">@"stringOnFoo"</span>];</div><div class="line">    stringOnFoo = inValue;</div><div class="line">    [<span class="keyword">self</span> didChangeValueForKey:<span class="string">@"stringOnFoo"</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;如果我更改了一个属性的值，KVO会帮助我们检测这个值的变化，从而通知我们这个值改变了。典型的观察者模式。当然我想起在UNITY3D中，如果检视面板的数值发生改变对应的GameObject发生位移之类的。我曾经实现了一个inspector的编辑器类，值改变直接通知(其实是调用)对应的函数。在iOS这里 一切发生的那么自然。不需要额外实现 这是iOS的特性之一 名曰：KVO 。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://vrast.cn/categories/iOS/"/>
    
    
      <category term="KVO" scheme="http://vrast.cn/tags/KVO/"/>
    
  </entry>
  
  <entry>
    <title>KVC in iOS</title>
    <link href="http://vrast.cn/posts/8779cbe4/"/>
    <id>http://vrast.cn/posts/8779cbe4/</id>
    <published>2017-03-02T10:24:06.000Z</published>
    <updated>2017-03-02T12:24:26.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>在 C# 里我们常用 .net reflect 类库配合typeof/getType来反射设置函数与字段等等。在iOS里也有这样的功能，比C#的门槛低的多。只要你合乎规范的定义函数与属性字段，就能方便的使用。</p>
</blockquote>
<a id="more"></a>
<h1 id="使用KVC"><a href="#使用KVC" class="headerlink" title="使用KVC"></a>使用KVC</h1><p>下面的函数 我将接通过KVC的接口 setValue forKey &amp;&amp; setValue forKeyPath ，来设置属性 与 调用方法。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Foo.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Bar.h"</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    Foo* foo = [[Foo alloc]init];</div><div class="line">    foo.bar = [[Bar alloc]init];</div><div class="line"></div><div class="line">    </div><div class="line">    [foo setValue:<span class="string">@"blah blah"</span> forKey:<span class="string">@"stringOnFoo"</span>];</div><div class="line">    [foo setValue:<span class="string">@"testforkeyle"</span> forKeyPath:<span class="string">@"bar.stringOnBar"</span>];</div><div class="line">    [foo valueForKeyPath:<span class="string">@"Log"</span>];<span class="comment">//Just Test log 直接访问了实例方法</span></div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,foo.bar.stringOnBar); <span class="comment">//testforkeyle</span></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>,foo.stringOnFoo); <span class="comment">//blah blah</span></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使用KVC在便利数组上尤为方便，下面是使用@sum函数直接给数组的price属性求和。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[foo.bar.array valueForKeyPath:<span class="string">@"@sum.price"</span>];</div></pre></td></tr></table></figure>
<h1 id="KVC的其他函数"><a href="#KVC的其他函数" class="headerlink" title="KVC的其他函数"></a>KVC的其他函数</h1><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//对于KVC的一些命令 ，如果要操作 NSArray 之类的字典可以方便的调用。类似C#的Linq for Object</span></div><div class="line">@avg</div><div class="line">@count</div><div class="line">@max</div><div class="line">@min</div><div class="line">@sum</div><div class="line">@unionOfArrays/@distinctUnionOfArrays   <span class="comment">//返回一个包含所有数组的数组 / 返回一个不重复的集合元素</span></div><div class="line">@unionOfSets/@distinctUnionOfSets       <span class="comment">//返回一个包含所有集合的集合 / 返回一个不重复的集合元素</span></div><div class="line">@unionOfObjects/@distinctUnionOfObjects <span class="comment">//返回一个包含所有元素的数组 / 返回一个不重复元素的数组</span></div></pre></td></tr></table></figure>
<h1 id="使用要求"><a href="#使用要求" class="headerlink" title="使用要求"></a>使用要求</h1><ol>
<li>骆驼命名法,不能数字开头</li>
<li>不能包含空格</li>
<li>键必须是ASCII编码的</li>
<li>使用默认的get/set</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;在 C# 里我们常用 .net reflect 类库配合typeof/getType来反射设置函数与字段等等。在iOS里也有这样的功能，比C#的门槛低的多。只要你合乎规范的定义函数与属性字段，就能方便的使用。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://vrast.cn/categories/iOS/"/>
    
    
      <category term="KVC" scheme="http://vrast.cn/tags/KVC/"/>
    
  </entry>
  
  <entry>
    <title>AI Design 1</title>
    <link href="http://vrast.cn/posts/d1301104/"/>
    <id>http://vrast.cn/posts/d1301104/</id>
    <published>2017-03-01T14:35:29.000Z</published>
    <updated>2017-03-03T08:08:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>这个系列是我阅读 UNITY5.X AI PROGRAMMING COOKBOOK 的笔记。有好又坏 请酌情阅读，有不当之处还请指出。<br><a id="more"></a></p>
<p>本章主要概述让 AI 更智能的移动。对应到原书也就是第一章节。</p>
<h1 id="使AI移动"><a href="#使AI移动" class="headerlink" title="使AI移动"></a>使AI移动</h1><p>这三个类的工作如下。</p>
<ol>
<li>Agent负责 计算当前帧的移动与下一帧的移动。</li>
<li>AgentBehaviour负责抽象Steering的计算过程。</li>
<li>Steering包含了Agent需要计算的数据。</li>
</ol>
<p>每当需要扩展一个新的移动行为，则只需要增加一个 AgentBehaviour 类型的派生即可。</p>
<h2 id="脚本时序"><a href="#脚本时序" class="headerlink" title="脚本时序"></a>脚本时序</h2><p><img src="/uploads/QQ20170302-223554@2x.jpg" alt="脚本调用频率"><br>所有的脚本按照优先级调用。例如 检测与执行AI的移动的Agent脚本调用最频繁。其他由 AgentBehaviour 派生的脚本次之。</p>
<h2 id="基础结构"><a href="#基础结构" class="headerlink" title="基础结构"></a>基础结构</h2><blockquote>
<p>这里详细介绍了利用 Agent/AgentBehaviour/Steering 三个类进行基础的 AI 结构搭建。当然代码里有一些 Bad Smell ,比如 Steering 类的 new ，每个行为返回一个Steering毫无例外的都会new一次。当然这完全是可以规避的，这里并不作代码优化的讨论 所以只是提到。</p>
</blockquote>
<h3 id="Agent-代理"><a href="#Agent-代理" class="headerlink" title="Agent 代理"></a>Agent 代理</h3><p>Agent 通过 Update 与 LateUpdate 来计算当前帧与下一帧的移动速度角度。<br>其中实际给 GameObject 做位移的代码就只有两句 Translate／Rotate 。</p>
<ul>
<li>Update ：执行当前帧的物体的移动与角度</li>
<li>LateUpdate ：计算下一帧的物体的移动与角度数值</li>
</ul>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Agent</span> : <span class="title">MonoBehaviour</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">float</span> maxSpeed;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">float</span> maxAccel;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">float</span> orientation;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">float</span> rotation;</div><div class="line">    <span class="keyword">public</span> Vector3 velocity;</div><div class="line">    <span class="keyword">protected</span> Steering steering;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span> (<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        velocity = Vector3.zero;</div><div class="line">        steering = <span class="keyword">new</span> Steering();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetSteering</span> (<span class="params">Steering steering</span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">this</span>.steering = steering;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        Vector3 displacement = velocity * Time.deltaTime;</div><div class="line">        orientation += rotation * Time.deltaTime;</div><div class="line">        <span class="comment">// we need to limit the orientation values</span></div><div class="line">        <span class="comment">// to be in the range (0 – 360)</span></div><div class="line">        <span class="keyword">if</span> (orientation &lt; <span class="number">0.0</span>f)</div><div class="line">            orientation += <span class="number">360.0</span>f;</div><div class="line">        <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params">orientation &gt; <span class="number">360.0</span>f</span>)</span></div><div class="line">            orientation -= <span class="number">360.0</span>f;</div><div class="line">        transform.Translate(displacement, Space.World);</div><div class="line">        transform.rotation = <span class="keyword">new</span> Quaternion();</div><div class="line">        transform.Rotate(Vector3.up, orientation);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">LateUpdate</span> (<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        velocity += steering.linear * Time.deltaTime;</div><div class="line">        rotation += steering.angular * Time.deltaTime;</div><div class="line">        <span class="keyword">if</span> (velocity.magnitude &gt; maxSpeed)</div><div class="line">        &#123;</div><div class="line">            velocity.Normalize();</div><div class="line">            velocity = velocity * maxSpeed;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (steering.angular == <span class="number">0.0</span>f)</div><div class="line">        &#123;</div><div class="line">            rotation = <span class="number">0.0</span>f;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (steering.linear.sqrMagnitude == <span class="number">0.0</span>f)</div><div class="line">        &#123;</div><div class="line">            velocity = Vector3.zero;</div><div class="line">        &#125;</div><div class="line">        steering = <span class="keyword">new</span> Steering();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Steering-数据载体"><a href="#Steering-数据载体" class="headerlink" title="Steering 数据载体"></a>Steering 数据载体</h3><p>Steering 承载了代理(Agent)需要计算的原始数据。数据的表现直接会影响到计算的 AgentBehaviour / Agent的计算结果。</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Steering</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">float</span> angular;</div><div class="line">    <span class="keyword">public</span> Vector3 linear;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Steering</span> (<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        angular = <span class="number">0.0</span>f;</div><div class="line">        linear = <span class="keyword">new</span> Vector3();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="AgentBehaviour-代理行为"><a href="#AgentBehaviour-代理行为" class="headerlink" title="AgentBehaviour 代理行为"></a>AgentBehaviour 代理行为</h3><p>由于 gentBehaviour 是Agent的数据提供方。所以他主要的职责就是派生与扩展。<br>新的类型将会继承自 AgentBehaviour 并且会重写 GetSteering() 函数来丰富表现。<br>接下来都是介绍 AgentBehaviour 脚本派生的行为。</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AgentBehaviour</span> : <span class="title">MonoBehaviour</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> GameObject target;</div><div class="line">    <span class="keyword">protected</span> Agent agent;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Awake</span> (<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        agent = gameObject.GetComponent&lt;Agent&gt;();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Update</span> (<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        agent.SetSteering(GetSteering());</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> Steering <span class="title">GetSteering</span> (<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Steering();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="更加智能的移动"><a href="#更加智能的移动" class="headerlink" title="更加智能的移动"></a>更加智能的移动</h2><h3 id="Seek-搜索"><a href="#Seek-搜索" class="headerlink" title="Seek 搜索"></a>Seek 搜索</h3><p>上面说到 AgentBehaviour 代理行为，是可以派生的。我们可以直接重写其 GetSteering 函数，来增加不同的表现。<br>这里干了两件事</p>
<ol>
<li>获取朝向目标的向量</li>
<li>目标朝向目标的向量归一化，乘以当前速度。也就是获得了 朝向目标的速度的向量。</li>
</ol>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Seek</span> : <span class="title">AgentBehaviour</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> Steering <span class="title">GetSteering</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        Steering steering = <span class="keyword">new</span> Steering();</div><div class="line">        steering.linear = target.transform.position - transform.position;</div><div class="line"></div><div class="line">        steering.linear.Normalize();</div><div class="line">        steering.linear = steering.linear * agent.maxAccel;</div><div class="line">        <span class="keyword">return</span> steering;</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Purse-追逐"><a href="#Purse-追逐" class="headerlink" title="Purse 追逐"></a>Purse 追逐</h3><p>在 GetSteering() 函数中有这样的逻辑存在。<br>追逐的目标 targetAux ， 所以需要预先计算(预判单位时间内) targetAux 可能到达的位置(这里用target表示)。maxPrediction变量在这里用来控制预判的时间。<br>我们知道 任何数值都需要规范化的 例如常用的 Math.Clamp 函数。我们应该尽量将 maxPrediction 值控制在正常范围之内。</p>
<p>通过 speed &lt;= distance / maxPrediction </p>
<ul>
<li>speed ：为当前追踪的物体真实速度。</li>
<li>distance ：为当前追踪的物体一共走过的距离。</li>
<li>maxPrediction ：预设的预测时间。</li>
</ul>
<blockquote>
<p>这样可以大胆猜测 为当前追踪的物体 正处于匀速 或者 加速中</p>
</blockquote>
<p><code>distance / maxPrediction </code>我们最终得到的 速度 就是物体的 预测速度。我们拿着 预测速度 与 speed 做一个比较。如果预测的速度小于真实速度，那么这个预测值出乎意料的错误。我们需要重新计算一个更真实合理的预测值。<br><code>prediction = distance / speed; </code> 这里计算了一个中规中矩的预测值。<br>最终通过 <code>targetAgent.velocity * prediction </code>获取 预测时间 内运动的距离。</p>
<blockquote>
<p>对于刚才的猜测结果，有一种条件下是有问题的，那就是当 当前追踪的物体 突然静止／或者本身就是静止的。由于脚本执行的时序问题，追逐到物体的时候会直接穿插过去(追过头了)，然后接着反复运动。这里就要用到 Arraying 脚本了，后文就会介绍到。</p>
</blockquote>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Pursue</span> : <span class="title">Seek</span> </div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">float</span> maxPrediction;</div><div class="line">    <span class="keyword">private</span> GameObject targetAux;</div><div class="line">    <span class="keyword">private</span> Agent targetAgent;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">           <span class="keyword">base</span>.Awake();</div><div class="line">           targetAgent = target.GetComponent&lt;Agent&gt;();</div><div class="line">           targetAux = target;</div><div class="line">           target = <span class="keyword">new</span> GameObject();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">OnDestroy</span> (<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">           Destroy(targetAux);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> Steering <span class="title">GetSteering</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">           Vector3 direction = targetAux.transform.position - transform.position;</div><div class="line">           <span class="keyword">float</span> distance = direction.magnitude;</div><div class="line">           <span class="keyword">float</span> speed = agent.velocity.magnitude;</div><div class="line">           <span class="keyword">float</span> prediction;</div><div class="line"></div><div class="line">           <span class="keyword">if</span> (speed &lt;= distance / maxPrediction)</div><div class="line">               prediction = maxPrediction;</div><div class="line">           <span class="keyword">else</span></div><div class="line">               prediction = distance / speed;</div><div class="line">           target.transform.position = targetAux.transform.position;</div><div class="line">           target.transform.position += targetAgent.velocity * prediction;</div><div class="line">           <span class="keyword">return</span> <span class="keyword">base</span>.GetSteering();</div><div class="line">     &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Flee-逃离"><a href="#Flee-逃离" class="headerlink" title="Flee 逃离"></a>Flee 逃离</h3><p>顾名思义 Flee 肯定和 Seek 相反。事实也正是如此，获取了与目标相反方向的速度的向量。</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Flee</span> : <span class="title">AgentBehaviour</span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> Steering <span class="title">GetSteering</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        Steering steering = <span class="keyword">new</span> Steering();</div><div class="line">        steering.linear = transform.position - target.transform.position;</div><div class="line">        steering.linear.Normalize();</div><div class="line">        steering.linear = steering.linear * agent.maxAccel;</div><div class="line">        <span class="keyword">return</span> steering;</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Evade-规避"><a href="#Evade-规避" class="headerlink" title="Evade 规避"></a>Evade 规避</h3><p>规避(Evade) 代码与 Pursue 代码一致。在 Flee/Seek 层，二者做了区分。</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Evade</span> : <span class="title">Flee</span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">float</span> maxPrediction;</div><div class="line">    <span class="keyword">private</span> GameObject targetAux;</div><div class="line">    <span class="keyword">private</span> Agent targetAgent;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">base</span>.Awake();</div><div class="line">        targetAgent = target.GetComponent&lt;Agent&gt;();</div><div class="line">        targetAux = target;</div><div class="line">        target = <span class="keyword">new</span> GameObject();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> Steering <span class="title">GetSteering</span>(<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        Vector3 direction = targetAux.transform.position - transform.position;</div><div class="line">        <span class="keyword">float</span> distance = direction.magnitude;</div><div class="line">        <span class="keyword">float</span> speed = agent.velocity.magnitude;</div><div class="line">        <span class="keyword">float</span> prediction;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (speed &lt;= distance / maxPrediction)</div><div class="line">            prediction = maxPrediction;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            prediction = distance / speed;</div><div class="line">        target.transform.position = targetAux.transform.position;</div><div class="line">        target.transform.position += targetAgent.velocity * prediction;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">base</span>.GetSteering();</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">OnDestroy</span> (<span class="params"></span>)</span></div><div class="line">    &#123;</div><div class="line">        Destroy(targetAux);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>本篇到此结束，本文主要介绍了 AI 行为的基础结构 与 其何如派生出来行为。下一篇会着重介绍派生出的其他行为与详细算法(实现)。</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这个系列是我阅读 UNITY5.X AI PROGRAMMING COOKBOOK 的笔记。有好又坏 请酌情阅读，有不当之处还请指出。&lt;br&gt;
    
    </summary>
    
      <category term="UNITY3D" scheme="http://vrast.cn/categories/UNITY3D/"/>
    
    
      <category term="AI" scheme="http://vrast.cn/tags/AI/"/>
    
  </entry>
  
  <entry>
    <title>Properties in iOS</title>
    <link href="http://vrast.cn/posts/f9b2637/"/>
    <id>http://vrast.cn/posts/f9b2637/</id>
    <published>2017-02-28T07:40:00.000Z</published>
    <updated>2017-02-28T11:05:09.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>翻译一篇iOS平台OC语法中的Properties用法及说明 <a href="http://rypress.com/tutorials/objective-c/properties" target="_blank" rel="external">原文地址</a></p>
</blockquote>
<a id="more"></a>
<h1 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h1><p>一个Object’s的属性可以让其他的Objects来更改它的状态。但是，一个好的面向对对象程序设计中，不可以直接的访问到这个object的状态。作为代替。访问方法(getter &amp; setters)用来抽象与底层的数据交互。</p>
<p><img src="/uploads/accessor-methods.jpg" alt="通过属性操作的方法交互"></p>
<p>@property 命令的目标是通过生成操作函数来更简单的访问。它允许你在语义级别指定公共属性的行为，并且会为你处理实现细节。<br>该模块概括了允许您更改getter和setter行为的各种属性。这些属性中的一些确定属性如何处理其底层内存。所以这个模块也可以作为一个介绍内存管理的实例在Objective-C。 有关更详细的讨论，<a href="http://rypress.com/tutorials/objective-c/properties" target="_blank" rel="external">请参阅内存管理</a>。</p>
<h1 id="property-命令"><a href="#property-命令" class="headerlink" title="@property 命令"></a>@property 命令</h1><p>首先，让我们看看当我们使用@property指令时发生了什么。思考接下来的 car class的接口与相关实现。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Car.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Car</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> <span class="built_in">BOOL</span> running;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Car.m</span></div><div class="line"><span class="meta">#import <span class="meta-string">"Car.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Car</span></span></div><div class="line"></div><div class="line"><span class="keyword">@synthesize</span> running = _running;    <span class="comment">// Optional for Xcode 4.4+</span></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>编译器会生成 running 属性的 getter &amp; setter 方法。他默认的命名惯例是使用属性本身(名字)作为getter，setter使用set作为前缀并且使用下划线在这个实例变量上。就像是这样：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)running &#123;</div><div class="line">    <span class="keyword">return</span> _running;</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)setRunning:(<span class="built_in">BOOL</span>)newValue &#123;</div><div class="line">    _running = newValue;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在使用 @property 命令声明属性之后，你可以调用这些方法，就像它已经包含在你的接口与实现类中一样。你可以在 Car.m 重写它们 支持制定 getter/setters.但是他将要强制使用 @synthesize 命令。然而，自从 @property 属性使你在抽象级别上做这些，你很少需要定制访问接口。<br>通过点表示法访问的属性被转换为幕后的上述访问器方法，因此，当您从其中读取值时，下面的 honda.running代码实际上调用setRunning：当你为它赋值和运行时从它读取：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.m</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Car.h"</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        Car *honda = [[Car alloc] init];</div><div class="line">        honda.running = <span class="literal">YES</span>;                <span class="comment">// [honda setRunning:YES]</span></div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%d"</span>, honda.running);        <span class="comment">// [honda running]</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>要更改生成的访问器的行为，可以在@property 指令后面的括号中指定属性。 本模块的其余部分介绍可用的属性。</p>
<h1 id="getter-与-setter-属性"><a href="#getter-与-setter-属性" class="headerlink" title="getter= 与 setter= 属性"></a>getter= 与 setter= 属性</h1><p>如果你不喜欢 @property 的命名惯例，你可以使用 getter= and setter= 属性，更改 getter/setter 的方法名。一个常见的用例是 Boolean 属性，它的getter常用前缀是 is。尝试在下面的 Car.h 中更改属性的声明。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">getter</span>=isRunning) <span class="built_in">BOOL</span> running;</div></pre></td></tr></table></figure>
<p>现在这个生成的访问器叫 isRunning 与 setRunning. 注意这个访问器 他的公开属性仍旧叫 running 。这是你为什么最好要使用点语法。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Car *honda = [[Car alloc] init];</div><div class="line">honda.running = <span class="literal">YES</span>;                <span class="comment">// [honda setRunning:YES]</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"%d"</span>, honda.running);        <span class="comment">// [honda isRunning]</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"%d"</span>, [honda running]);      <span class="comment">// Error: method no longer exists</span></div></pre></td></tr></table></figure>
<p>这些都是只使用一个参数的属性（存取器方法名称） - 其他的都是布尔标志。</p>
<h1 id="The-readonly-Attribute"><a href="#The-readonly-Attribute" class="headerlink" title="The readonly Attribute"></a>The readonly Attribute</h1><p>readonly属性是最简单去设置一个属性的只读。他删除了 setter 方法，阻止点语法进行分配。但是 getter 方法不受影响。在这个例子里面。我们像下面这样更改 Car 的接口。注意 你可以使用多个属性 用逗号 分隔。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Car</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">getter</span>=isRunning, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> running;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)startEngine;</div><div class="line">- (<span class="keyword">void</span>)stopEngine;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>而不是让其他对象更改running属性，我们将通过startEngine和stopEngine方法在内部进行设置。 相应的实现可以在下面找到。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Car.m</span></div><div class="line"><span class="meta">#import <span class="meta-string">"Car.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Car</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)startEngine &#123;</div><div class="line">    _running = <span class="literal">YES</span>;</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)stopEngine &#123;</div><div class="line">    _running = <span class="literal">NO</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>上面直到这一点，属性真的只是方便的快捷方式，让我们避免编写样板getter和setter方法。 剩余的属性不会出现这种情况，这会显着改变属性的行为。 它们也只适用于存储Objective-C对象（与原始C数据类型相反）的属性。</p>
<h1 id="The-nonatomic-Attribute"><a href="#The-nonatomic-Attribute" class="headerlink" title="The nonatomic Attribute"></a>The nonatomic Attribute</h1><p>原子性与属性在线程环境中的行为有关。当你在多于一个线程的情况下可能出现同时读写一个属性。这意味着读写可能被另外一个操作打断。可能损坏数据。<br>原子属性锁定底层对象以防止这种情况发生(google翻译这里)，以防止发生这种情况，保证get或set操作使用完整的值。 然而，重要的是要理解这只是线程安全的一个方面 - 使用原子属性并不一定意味着你的代码是线程安全的。<br>使用 @property 声明的属性在默认情况下是原子的，这会产生一些开销。 所以，如果你不是在多线程环境（或者你正在实现自己的线程安全），你会想要覆盖这个行为与 nonatomic 属性，如下：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *model;</div></pre></td></tr></table></figure>
<p>还有一个小的，实际的警告与原子属性。 原子属性的访问器必须是生成的或用户定义的。 只有非原子属性允许您将合成存取器与自定义存取器混合和匹配。 你可以通过从上面的代码中删除非原子并在Car.m中添加自定义getter来看到这一点。</p>
<h1 id="Memory-Management"><a href="#Memory-Management" class="headerlink" title="Memory Management"></a>Memory Management</h1><p>在任何OOP语言中，对象驻留在计算机的内存中，并且尤其是在移动设备上 - 这是一种稀缺的资源。 内存管理系统的目标是通过以有效的方式创建和销毁对象来确保程序不占用任何更多的空间。</p>
<p>许多语言通过垃圾回收实现这一点，但Objective-C使用一种更有效的替代方法称为对象所有权。 当你开始与一个对象进行交互时，你会说它拥有该对象，这意味着只要你使用它就保证存在。 当你完成它，你放弃所有权，如果对象没有其他所有者，操作系统销毁对象和释放底层内存。</p>
<p><img src="/uploads/object-ownership.jpg" alt="所有关系"></p>
<p>随着 <a href="http://rypress.com/tutorials/objective-c/memory-management.html#automatic-reference-counting" target="_blank" rel="external">自动引用计数</a> 的出现，编译器自动管理所有对象所有权。 在大多数情况下，这意味着你永远不会担心内存管理系统如何工作。 但是，你必须了解@property的strong，week和copy属性，因为他们告诉编译器应该有什么样的关系对象。</p>
<h1 id="The-strong-Attribute"><a href="#The-strong-Attribute" class="headerlink" title="The strong Attribute"></a>The strong Attribute</h1><p>strong属性会为分配给属性的任何对象创建一个拥有关系。 这是所有对象属性的隐式行为，这是一个安全的默认值，因为它确保值存在，只要它被分配给属性。<br>让我们通过创建另一个名为Person的类来看看这是如何工作的。 它的接口只是声明一个name属性：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Person.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *name;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>实现如下所示。 它使用由@property生成的默认访问器。 它还重写了NSObject的description方法，该方法返回对象的字符串表示形式。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Person.m</span></div><div class="line"><span class="meta">#import <span class="meta-string">"Person.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Person</span></span></div><div class="line"></div><div class="line">- (<span class="built_in">NSString</span> *)description &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>接下来，让我们添加一个Person属性到Car类。 为Car.h更改为以下内容。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Car.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Person.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Car</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *model;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) Person *driver;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>然后，思考main.m的以下迭代：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.m</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Car.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Person.h"</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        Person *john = [[Person alloc] init];</div><div class="line">        john.name = <span class="string">@"John"</span>;</div><div class="line">        </div><div class="line">        Car *honda = [[Car alloc] init];</div><div class="line">        honda.model = <span class="string">@"Honda Civic"</span>;</div><div class="line">        honda.driver = john;</div><div class="line">        </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@ is driving the %@"</span>, honda.driver, honda.model);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>由于 driver 是一个 strong 关联，honda对象拥有john的所有权。 这确保它将有效，只要 honda 需要它。</p>
<h1 id="The-weak-Attribute"><a href="#The-weak-Attribute" class="headerlink" title="The weak Attribute"></a>The weak Attribute</h1><p>大多数时候，strong属性直观地是你想要的对象属性。 然而，如果我们需要一个从 driver 到他驾驶的Car对象的引用，强引用会产生问题。 首先，让我们为Person.h添加一个car属性：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Person.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@class</span> <span class="title">Car</span>;</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *name;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) Car *car;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>@class Car行是Car类的提前声明。 这就像告诉编译器，“相信我，Car类存在，所以不要尝试找到它现在。”我们必须这样做，而不是我们通常的#import语句，因为Car还导入 Person.h，我们将 有无限循环的导入。 （编译器不喜欢无尽循环。）接下来，在honda.driver分配之后，将下面的行添加到main.m：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">honda.driver = john;</div><div class="line">john.car = honda;       <span class="comment">// Add this line</span></div></pre></td></tr></table></figure>
<p>现在我们有一个honda到john的所属关系以及另外一个所有关系即john到honda。所以内存管理系统不能销毁它们，如果它们长久的互相需要。</p>
<p><img src="/uploads/retain-cycle.jpg" alt="在Car 与 Person之间循环依赖"></p>
<p>它称之为 循环依赖 ，这就是内存泄漏的出处。内存泄漏是不好的。幸运的是，很容易修复这个问题，只需要在属性中添加 weak reference 。在 Person.h ，修改 car 的声明如下：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) Car *car;</div></pre></td></tr></table></figure>
<p>weak 属性给 car 创建了一个无所有者的关系。它允许 john 持有一个 honda 的引用 在循环依赖期间。但是，这也意味着 john还持有引用的时候 honda 可能被销毁。如果发生了，weak 属性将会方便的将 car 设置为 nil 来避免 dangling（悬挂指针） 指针。</p>
<p>这里我说明一下悬挂指针，文中没有详细说明：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">如果指针在被释放后，仍然引用原来的内存，就叫做悬挂指针。该指针不指向任何有效的对象。有时称为过早释放。</div><div class="line"></div><div class="line">使用悬挂指针能导致几种不同的问题，包括：</div><div class="line"></div><div class="line">不可预知的行为，如果访问内存</div><div class="line">分段错误，当内存不再是可访问</div><div class="line">潜在的安全风险</div><div class="line">如下情况将产生这些错误：</div><div class="line">释放后访问内存</div><div class="line">一个指针返回到前一个函数调用的自动变量</div></pre></td></tr></table></figure></p>
<p><img src="/uploads/weak-reference.jpg" alt="Person对car持有若引用"></p>
<p>弱属性的常见用例是父子数据结构。 按照惯例，父对象应该使用它的子保持一个强引用，并且子应该存储一个弱引用返回父对象。 弱引用也是代理设计模式的固有部分。要去除的一点是，两个对象应该永远不会有强烈的对方引用。 弱属性使得可以维持周期性关系而不创建保留周期。</p>
<h1 id="The-copy-Attribute"><a href="#The-copy-Attribute" class="headerlink" title="The copy Attribute"></a>The copy Attribute</h1><p>copy属性是strong的替代。 它不是获取现有对象的所有权，而是创建一个分配给该属性的副本，然后拥有该属性的所有权。 只有符合NSCopying协议的对象才能使用此属性。</p>
<p>表示值（与连接或关系相反）的属性是复制的良好候选。 例如，开发人员通常复制NSString属性，而不是强烈引用它们：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Car.h</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *model;</div></pre></td></tr></table></figure>
<p>这里还是看原文吧。<br>Now, Car will store a brand new instance of whatever value we assign to model. If you’re working with mutable values, this has the added perk of freezing the object at whatever value it had when it was assigned. This is demonstrated below:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.m</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"Car.h"</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        Car *honda = [[Car alloc] init];</div><div class="line">        <span class="built_in">NSMutableString</span> *model = [<span class="built_in">NSMutableString</span> stringWithString:<span class="string">@"Honda Civic"</span>];</div><div class="line">        honda.model = model;</div><div class="line">        </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, honda.model);</div><div class="line">        [model setString:<span class="string">@"Nissa Versa"</span>];</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, honda.model);            <span class="comment">// Still "Honda Civic"</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>NSMutableString是NSString的子类，可以直接编辑。 如果model属性没有创建原始实例的副本，我们将能够在第二个NSLog()输出中看到更改的字符串（Nissan Versa）。</p>
<h1 id="Other-Attributes"><a href="#Other-Attributes" class="headerlink" title="Other Attributes"></a>Other Attributes</h1><p>上面的 @property 属性是现代 Objective-C应用程序（iOS 5+）所需要的，但是你可能会在旧的库或文档中遇到其他一些属性。</p>
<h1 id="The-retain-Attribute"><a href="#The-retain-Attribute" class="headerlink" title="The retain Attribute"></a>The retain Attribute</h1><p>retain属性是strong的手动保留版本，它具有完全相同的效果：声明所分配的值的所有权。 您不应在自动引用计数环境中使用此引用。</p>
<h1 id="The-unsafe-unretained-Attribute"><a href="#The-unsafe-unretained-Attribute" class="headerlink" title="The unsafe_unretained Attribute"></a>The unsafe_unretained Attribute</h1><p>具有unsafe_unretained属性的属性的行为类似于weak属性，但是如果引用的对象被销毁，它们不会自动将其值设置为nil。 你应该需要使用unsafe_unretained的唯一原因是使你的类与不支持weak属性的代码兼容。</p>
<h1 id="The-assign-Attribute"><a href="#The-assign-Attribute" class="headerlink" title="The assign Attribute"></a>The assign Attribute</h1><p>具有unsafe_unretained属性的属性的行为类似于weak属性，但是如果引用的对象被销毁，它们不会自动将其值设置为nil。 你应该需要使用unsafe_unretained的唯一原因是使你的类与不支持weak属性的代码兼容。</p>
<h1 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h1><p>此模块介绍了所有的@property属性选择，我们希望你感觉相对舒服的修改生成的访问器方法的行为。 请记住，所有这些属性的目标是帮助您通过让编译器自动确定其表示方式来关注需要记录的数据。 它们总结如下。</p>
<p>Attribute   Description<br>getter= Use a custom name for the getter method.<br>setter= Use a custom name for the setter method.<br>readonly    Don’t synthesize a setter method.<br>nonatomic   Don’t guarantee the integrity of accessors in a multi-threaded environment. This is more efficient than the default atomic behavior.<br>strong  Create an owning relationship between the property and the assigned value. This is the default for object properties.<br>weak    Create a non-owning relationship between the property and the assigned value. Use this to prevent retain cycles.<br>copy    Create a copy of the assigned value instead of referencing the existing instance.<br>Now that we’ve got properties out of the way, we can take an in-depth look at the other half of Objective-C classes: methods. We’ll explore everything from the quirks behind their naming conventions to dynamic method calls.</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;翻译一篇iOS平台OC语法中的Properties用法及说明 &lt;a href=&quot;http://rypress.com/tutorials/objective-c/properties&quot;&gt;原文地址&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://vrast.cn/categories/iOS/"/>
    
    
      <category term="Objective-C" scheme="http://vrast.cn/tags/Objective-C/"/>
    
  </entry>
  
  <entry>
    <title>在MAC平台体验DotnetCore</title>
    <link href="http://vrast.cn/posts/1f2cd62/"/>
    <id>http://vrast.cn/posts/1f2cd62/</id>
    <published>2017-01-15T03:37:45.000Z</published>
    <updated>2017-01-15T04:37:06.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>这两天看到有朋友讨论 微软的 .netCore 这个跨平台项目。觉得有点意思，然后简单的了解一下。随后便有了这一篇博文。本文 记录在MACOS下使用 .netCore 开发所需准备与基础知识。</p>
</blockquote>
<a id="more"></a>
<h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><h2 id="下载所需环境"><a href="#下载所需环境" class="headerlink" title="下载所需环境"></a>下载所需环境</h2><p><img src="/uploads/QQ20170115-0@2x.jpg" alt=""><br>这里列出的所有安装命令可以在项目主页找到。<a href="https://www.microsoft.com/net/core#macos" target="_blank" rel="external">&gt;&gt; dotnetCore 主页 &lt;&lt;</a> 这里可以找到最新的 SDK 安装包。如果是使用的 MAC 直接使用 homeBrew 进行下载。</p>
<h3 id="Mac安装前准备"><a href="#Mac安装前准备" class="headerlink" title="Mac安装前准备"></a>Mac安装前准备</h3><p>这里需要安装并且配置 openssl 。如果配置完毕请看下一步。</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">brew update</div><div class="line">brew install openssl</div><div class="line">mkdir -p /usr/local/<span class="class"><span class="keyword">lib</span></span></div><div class="line">ln -s /usr/local/opt/openssl/<span class="class"><span class="keyword">lib</span>/<span class="title">libcrypto</span>.1.0.0.<span class="title">dylib</span> /<span class="title">usr</span>/<span class="title">local</span>/<span class="title">lib</span>/</span></div><div class="line">ln -s /usr/local/opt/openssl/<span class="class"><span class="keyword">lib</span>/<span class="title">libssl</span>.1.0.0.<span class="title">dylib</span> /<span class="title">usr</span>/<span class="title">local</span>/<span class="title">lib</span>/</span></div></pre></td></tr></table></figure>
<h2 id="安装SDK"><a href="#安装SDK" class="headerlink" title="安装SDK"></a>安装SDK</h2><p><img src="/uploads/QQ20170115-1@2x.jpg" alt="安装SDK"></p>
<h1 id="DotnetCore-Command"><a href="#DotnetCore-Command" class="headerlink" title="DotnetCore Command"></a>DotnetCore Command</h1><p>核心的命令如下。 其中 restore 命令必须要被执行至少一次。如果被你更改或第一次运行 会自动下载或添加所需依赖。这里做的十分的智能。如果是 VSCode 环境则会主动提示需要执行 restore 命令。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Common Commands:</div><div class="line">  new           Initialize <span class="selector-tag">a</span> basic <span class="selector-class">.NET</span> project ／ 创建一个基础项目</div><div class="line">  restore       Restore dependencies specified <span class="keyword">in</span> the <span class="selector-class">.NET</span> project ／ 初始化依赖项目，会重新检查配置中的依赖项。</div><div class="line">  build         Builds <span class="selector-tag">a</span> <span class="selector-class">.NET</span> project ／ 编译项目</div><div class="line">  publish       Publishes <span class="selector-tag">a</span> <span class="selector-class">.NET</span> project <span class="keyword">for</span> deployment (including the runtime) ／ 发布项目</div><div class="line">  run           Compiles and immediately executes <span class="selector-tag">a</span> <span class="selector-class">.NET</span> project ／ 在Launcher配置的输出环境中运行项目</div><div class="line">  test          Runs unit tests using the test runner specified <span class="keyword">in</span> the project ／ 运行单元测试</div><div class="line">  pack          Creates <span class="selector-tag">a</span> NuGet package ／ 创建一个NuGet包</div></pre></td></tr></table></figure>
<h2 id="在-Terminal-中-运行-HelloWorld"><a href="#在-Terminal-中-运行-HelloWorld" class="headerlink" title="在 Terminal 中 运行 HelloWorld"></a>在 Terminal 中 运行 HelloWorld</h2><p>我们在控制台中使用 DotnetCore 的命令，创建一个 HelloWorld 程序。用来检测环境是否 配置完毕。</p>
<p>流程如下：</p>
<ol>
<li>输入此命令创建演示用文件夹 <code>mkdir hwapp &amp;&amp; cd hwapp </code></li>
<li>创建基础项目<br><img src="/uploads/QQ20170115-2@2x.jpg" alt=""></li>
<li>使用dotnet restore命令初始化依赖<br><img src="/uploads/QQ20170115-3@2x.jpg" alt=""></li>
<li>使用dotnet run命令执行此项目<br><img src="/uploads/QQ20170115-4@2x.jpg" alt=""></li>
</ol>
<h1 id="关于-VSCode"><a href="#关于-VSCode" class="headerlink" title="关于 VSCode"></a>关于 VSCode</h1><p>本来这一章我是想介绍下AST.NET项目的。<br>但是这个东西要使用VSCode开发的话还是不现实。主要的原因是需要复杂的配置，不智能化。添加一个 Controller 都很麻烦。<br>所有的 command 都只能通过配置文件进行，还要手动校验那些配置是可用的 哪些需要更改。如果你是第一次使用vscode肯定要懵圈。<br>如果在 visualstudio 上使用直接可以支持发布到某个特定的平台。一个按钮为你省去所有烦恼。</p>
<blockquote>
<p>如果有时间花在配置所有的运行环境，我还是宁愿花时间想想 如何优化自己的代码 。</p>
</blockquote>
<h1 id="关于-VisualStudio-for-Mac"><a href="#关于-VisualStudio-for-Mac" class="headerlink" title="关于 VisualStudio for Mac"></a>关于 VisualStudio for Mac</h1><p>前一阵微软弄了个 visualstudio for mac .未来有很大可能会将 .netcore集成到这个 IDE 上。<br>当然我已经试用过了这个 IDE .这个工具其实就是 XamarinStudio 拿来改的。<br>我用XamarinStudio已经用了快3年了。但是没有见过如此不好用的 XamarinStudio FOR VisualStudio 。<br>举个例子 ： 我使用 tab 键 自动完成代码的时候，居然不能识别我正在编辑的字段，丢失了智能提示。<br>希望未来有改善的一天吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;这两天看到有朋友讨论 微软的 .netCore 这个跨平台项目。觉得有点意思，然后简单的了解一下。随后便有了这一篇博文。本文 记录在MACOS下使用 .netCore 开发所需准备与基础知识。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="DotNetCore" scheme="http://vrast.cn/categories/DotNetCore/"/>
    
    
      <category term="微软跨平台" scheme="http://vrast.cn/tags/%E5%BE%AE%E8%BD%AF%E8%B7%A8%E5%B9%B3%E5%8F%B0/"/>
    
  </entry>
  
  <entry>
    <title>MD5withRSA In C#</title>
    <link href="http://vrast.cn/posts/f773f5f3/"/>
    <id>http://vrast.cn/posts/f773f5f3/</id>
    <published>2017-01-12T03:44:52.000Z</published>
    <updated>2017-01-12T13:42:03.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>本章记录关于Java MD5withRSA加密算法的C#实现。由于C#不提供MD5withRSA的内置实现，所以必须依赖其他的第三方库。这里提供一个简单的sample来演绎[bouncycastle]的加密库。</p>
</blockquote>
<a id="more"></a>
<h1 id="MD5withRSA是什么？"><a href="#MD5withRSA是什么？" class="headerlink" title="MD5withRSA是什么？"></a>MD5withRSA是什么？</h1><ol>
<li>先使用MD5加密(不可逆转) 生成密文。</li>
<li>使用RSA继续加密 上一步的密文。</li>
</ol>
<h2 id="MD5是什么？"><a href="#MD5是什么？" class="headerlink" title="MD5是什么？"></a>MD5是什么？</h2><p>Message Digest Algorithm MD5（中文名为消息摘要算法第五版）为计算机安全领域广泛使用的一种散列函数，用以提供消息的完整性保护。该算法的文件号为RFC 1321（R.Rivest,MIT Laboratory for Computer Science and RSA Data Security Inc. April 1992）。 –<a href="http://baike.baidu.com/link?url=hNIwfVhJGcU5tD8CAqbon1Tc9WsA5YYUcYRR0mYa6F8PgsHOwDmswbrhmszud3DmHllrmm0DfHAAevsbMLXKT_" target="_blank" rel="external">来自百度百科</a></p>
<h2 id="RSA是什么"><a href="#RSA是什么" class="headerlink" title="RSA是什么?"></a>RSA是什么?</h2><p>RSA是目前最有影响力的公钥加密算法，它能够抵抗到目前为止已知的绝大多数密码攻击，已被ISO推荐为公钥数据加密标准。 –<a href="http://baike.baidu.com/link?url=B_ViRIN0m4B7JUU_v4nrz1o78Al5N0KSRofAUZmKgWlR3pfQMr1K9_BDbP1vxlG3700dSk1gnjf7PqgPhJUbPH660i5vMi-Ysuv-RXPjhxnRan7OPzSlRJWXsWbOQT_oOgDGjDnFQ1l2qJJu2NPKZa" target="_blank" rel="external">来自百度百科</a></p>
<h1 id="MD5withRSA-的使用场景"><a href="#MD5withRSA-的使用场景" class="headerlink" title="MD5withRSA 的使用场景"></a>MD5withRSA 的使用场景</h1><p>如果你在百度上搜索 MD5withRSA 恐怕搜到最多的就是关于建行支付的。对的，这个加密算法常用与支付阶段。主要用途是防篡改。一般来说传递明文 可能被黑客从传输阶段拦截，篡改，此时我们用私钥将MD5加密后的密文再加密与明文一起发送。服务器用公匙将密文解密此时得到md5的密文，然后将明文用md5加密得到密文，匹配这两个密文。如果一致则消息是未被篡改的。</p>
<h1 id="使用-BouncyCastle-Crypto-dll-演绎签名与验证签名"><a href="#使用-BouncyCastle-Crypto-dll-演绎签名与验证签名" class="headerlink" title="使用 BouncyCastle.Crypto.dll 演绎签名与验证签名"></a>使用 BouncyCastle.Crypto.dll 演绎签名与验证签名</h1><h2 id="加密支持列表"><a href="#加密支持列表" class="headerlink" title="加密支持列表"></a>加密支持列表</h2><p>Current feature list:</p>
<p>Generation and parsing of PKCS-12 files.<br>X.509: Generators and parsers for V1 and V3 certificates, V2 CRLs and attribute certificates.<br>PBE algorithms supported by PbeUtilities: PBEwithMD2andDES-CBC, PBEwithMD2andRC2-CBC, PBEwithMD5andDES-CBC, PBEwithMD5andRC2-CBC, PBEwithSHA1andDES-CBC, PBEwithSHA1andRC2-CBC, PBEwithSHA-1and128bitRC4, PBEwithSHA-1and40bitRC4, PBEwithSHA-1and3-keyDESEDE-CBC, PBEwithSHA-1and2-keyDESEDE-CBC, PBEwithSHA-1and128bitRC2-CBC, PBEwithSHA-1and40bitRC2-CBC, PBEwithHmacSHA-1, PBEwithHmacSHA-224, PBEwithHmacSHA-256, PBEwithHmacRIPEMD128, PBEwithHmacRIPEMD160, and PBEwithHmacRIPEMD256.<br>Signature algorithms supported by SignerUtilities: MD2withRSA, MD4withRSA, MD5withRSA, RIPEMD128withRSA, RIPEMD160withECDSA, RIPEMD160withRSA, RIPEMD256withRSA, SHA-1withRSA, SHA-224withRSA, SHA-256withRSAandMGF1, SHA-384withRSAandMGF1, SHA-512withRSAandMGF1, SHA-1withDSA, and SHA-1withECDSA.<br>Symmetric key algorithms: AES, Blowfish, Camellia, CAST5, CAST6, ChaCha, DES, DESede, GOST28147, HC-128, HC-256, IDEA, ISAAC, Noekeon, RC2, RC4, RC5-32, RC5-64, RC6, Rijndael, Salsa20, SEED, Serpent, Skipjack, TEA/XTEA, Threefish, Tnepres, Twofish, VMPC and XSalsa20.<br>Symmetric key modes: CBC, CFB, CTS, GOFB, OFB, OpenPGPCFB, and SIC (or CTR).<br>Symmetric key paddings: ISO10126d2, ISO7816d4, PKCS-5/7, TBC, X.923, and Zero Byte.<br>Asymmetric key algorithms: ElGamal, DSA, ECDSA, NaccacheStern and RSA (with blinding).<br>Asymmetric key paddings/encodings: ISO9796d1, OAEP, and PKCS-1.<br>AEAD block cipher modes: CCM, EAX, GCM and OCB.<br>Digests: GOST3411, Keccak, MD2, MD4, MD5, RIPEMD128, RIPEMD160, RIPEMD256, RIPEMD320, SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA3, Tiger, and Whirlpool.<br>XOFs: SHAKE.<br>Signer mechanisms: DSA, ECDSA, ECGOST3410, ECNR, GOST3410, ISO9796d2, PSS, RSA, X9.31-1998.<br>Key Agreement: Diffie-Hellman, EC-DH, EC-MQV, J-PAKE, SRP-6a.<br>Macs: CBCBlockCipher, CFBBlockCipher, CMAC, GMAC, GOST28147, HMac, ISO9797 Alg. 3, Poly1305, SipHash, SkeinMac, VMPCMAC.<br>PBE generators: PKCS-12, and PKCS-5 - schemes 1 and 2.<br>OpenPGP (RFC 4880)<br>Cryptographic Message Syntax (CMS, RFC 3852), including streaming API.<br>Online Certificate Status Protocol (OCSP, RFC 2560).<br>Time Stamp Protocol (TSP, RFC 3161).<br>TLS/DTLS client/server up to version 1.2, with support for the most common ciphersuites and extensions, and many less common ones. Non-blocking API available.<br>Elliptic Curve Cryptography: support for generic F2m and Fp curves, high-performance custom implementations for many standardized curves.<br>Reading/writing of PEM files, including RSA and DSA keys, with a variety of encryptions.<br>PKIX certificate path validation</p>
<h2 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></div><div class="line"><span class="comment"><span class="doctag">///</span> MD5withRSA Signing</span></div><div class="line"><span class="comment"><span class="doctag">///</span> https://www.vrast.cn</span></div><div class="line"><span class="comment"><span class="doctag">///</span> keyle_xiao 2017.1.12</span></div><div class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></div><div class="line"><span class="keyword">public</span>  <span class="keyword">class</span> <span class="title">MD5withRSASigning</span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">public</span> Encoding encoding = Encoding.UTF8;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">string</span> SignerSymbol = <span class="string">"MD5withRSA"</span>;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MD5withRSASigning</span>(<span class="params"></span>) </span>&#123; &#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MD5withRSASigning</span>(<span class="params">Encoding e, <span class="keyword">string</span> s</span>)</span></div><div class="line">	&#123;</div><div class="line">		encoding = e;</div><div class="line">		SignerSymbol = s;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">private</span> AsymmetricKeyParameter <span class="title">CreateKEY</span>(<span class="params"><span class="keyword">bool</span> isPrivate, <span class="keyword">string</span> key</span>)</span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">byte</span>[] keyInfoByte = Convert.FromBase64String(key);</div><div class="line"></div><div class="line">		<span class="keyword">if</span> (isPrivate)</div><div class="line">			<span class="keyword">return</span> PrivateKeyFactory.CreateKey(keyInfoByte);</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> PublicKeyFactory.CreateKey(keyInfoByte);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">Sign</span>(<span class="params"><span class="keyword">string</span> content, <span class="keyword">string</span> privatekey</span>)</span></div><div class="line">	&#123;</div><div class="line">		ISigner sig = SignerUtilities.GetSigner(SignerSymbol);</div><div class="line"></div><div class="line">		sig.Init(<span class="literal">true</span>, CreateKEY(<span class="literal">true</span>, privatekey));</div><div class="line"></div><div class="line">		<span class="keyword">var</span> bytes = encoding.GetBytes(content);</div><div class="line"></div><div class="line">		sig.BlockUpdate(bytes, <span class="number">0</span>, bytes.Length);</div><div class="line">		<span class="keyword">byte</span>[] signature = sig.GenerateSignature();</div><div class="line"></div><div class="line"></div><div class="line">		<span class="comment">/* Base 64 encode the sig so its 8-bit clean */</span></div><div class="line">		<span class="keyword">var</span> signedString = Convert.ToBase64String(signature);</div><div class="line"></div><div class="line">		<span class="keyword">return</span> signedString;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">Verify</span>(<span class="params"><span class="keyword">string</span> content, <span class="keyword">string</span> signData, <span class="keyword">string</span> publickey</span>)</span></div><div class="line">	&#123;</div><div class="line">		ISigner signer = SignerUtilities.GetSigner(SignerSymbol);</div><div class="line"></div><div class="line">		signer.Init(<span class="literal">false</span>, CreateKEY(<span class="literal">false</span>, publickey));</div><div class="line"></div><div class="line">		<span class="keyword">var</span> expectedSig = Convert.FromBase64String(signData);</div><div class="line"></div><div class="line">		<span class="comment">/* Get the bytes to be signed from the string */</span></div><div class="line">		<span class="keyword">var</span> msgBytes = encoding.GetBytes(content);</div><div class="line"></div><div class="line">		<span class="comment">/* Calculate the signature and see if it matches */</span></div><div class="line">		signer.BlockUpdate(msgBytes, <span class="number">0</span>, msgBytes.Length);</div><div class="line">		<span class="keyword">return</span> signer.VerifySignature(expectedSig);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="http://www.bouncycastle.org/csharp/" target="_blank" rel="external">bouncycastle官网</a><br><a href="http://www.cnblogs.com/dj258/p/6049786.html#3589515" target="_blank" rel="external">C# 与JAVA 的RSA 加密解密交互，互通，C#使用BouncyCastle来实现私钥加密，公钥解密的方法</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本章记录关于Java MD5withRSA加密算法的C#实现。由于C#不提供MD5withRSA的内置实现，所以必须依赖其他的第三方库。这里提供一个简单的sample来演绎[bouncycastle]的加密库。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="C#" scheme="http://vrast.cn/categories/C/"/>
    
    
      <category term="MD5withRSA" scheme="http://vrast.cn/tags/MD5withRSA/"/>
    
  </entry>
  
  <entry>
    <title>一次加载所有Shader</title>
    <link href="http://vrast.cn/posts/8cb143d1/"/>
    <id>http://vrast.cn/posts/8cb143d1/</id>
    <published>2017-01-09T13:00:25.000Z</published>
    <updated>2017-01-12T09:28:18.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>一次性加载所有的Shader.避免材质上的Shader丢失，5.X需要调用<code>Shader.WarmupAllShaders</code></p>
</blockquote>
<a id="more"></a>
<h1 id="ShaderVariantCollection-Document"><a href="#ShaderVariantCollection-Document" class="headerlink" title="ShaderVariantCollection Document"></a>ShaderVariantCollection Document</h1><p>Description</p>
<p>ShaderVariantCollection records which shader variants are actually used in each shader.</p>
<p>This is used for shader preloading (“warmup”), so that a game can make sure “actually required” shader variants are loaded at startup (or level load time), to avoid shader compilation related hiccups later on in the game.</p>
<p>In Unity, many shaders internally have multiple “variants”, to account for different light modes, lightmaps, shadows and so on. These variants are indentified by a shader pass type, and a set of shader keywords. See ShaderVariant.</p>
<p>Typical use of ShaderVariantCollection is to record the shader variants used during a play session from the editor (under Graphics Settings), save them out as an asset, and add to the list of preloaded shaders (again in Graphics Settings). Additionally, you could call WarmUp on a ShaderVariantCollection object manually.</p>
<p>ShaderVariantCollection generally replaces the old Shader.WarmupAllShaders function.</p>
<h1 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h1><p>对于Unity4.x版本，Shader的AssetBundle加载后只需LoadAll即可完成所有Shader的加载和解析，但对于Unity5.x版本，除执行LoadAllAssets操作外，还需要进行Shader.WarmupAllShaders操作，因为在Unity5.x版本中，Shader的解析和CreateGPUProgram操作是分离的。 – <a href="http://blog.uwa4d.com/archives/LoadingPerformance_Shader.html?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">摘录自UWA Unity加载模块深度解析（Shader篇)</a></p>
<h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="http://blog.csdn.net/ynnmnm/article/details/44674211" target="_blank" rel="external">Unity3D - 图形性能优化：优化着色器加载时间</a><br><a href="http://blog.uwa4d.com/archives/LoadingPerformance_Shader.html" target="_blank" rel="external">Unity加载模块深度解析（Shader篇)</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;一次性加载所有的Shader.避免材质上的Shader丢失，5.X需要调用&lt;code&gt;Shader.WarmupAllShaders&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="UNITY3D" scheme="http://vrast.cn/categories/UNITY3D/"/>
    
    
      <category term="Shader" scheme="http://vrast.cn/tags/Shader/"/>
    
  </entry>
  
  <entry>
    <title>MACOS开发环境配置</title>
    <link href="http://vrast.cn/posts/35d56e26/"/>
    <id>http://vrast.cn/posts/35d56e26/</id>
    <published>2017-01-05T06:43:07.000Z</published>
    <updated>2017-03-09T09:18:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>这里介绍了一些好用的插件 与 开发环境的配置。如果我发现还有什么好玩的会接着更新.</p>
</blockquote>
<a id="more"></a>
<h1 id="Homebrew"><a href="#Homebrew" class="headerlink" title="Homebrew"></a>Homebrew</h1><p>好用插件管理工具，Homebrew的开发者现在为apple工作了，Xcode内建的Package Manager就是他写的。<a href="http://brew.sh/index_zh-cn.html" target="_blank" rel="external">链接附上🔗 </a></p>
<h1 id="Oh-my-zsh"><a href="#Oh-my-zsh" class="headerlink" title="Oh-my-zsh"></a>Oh-my-zsh</h1><p><a href="http://ohmyz.sh" target="_blank" rel="external">超级shell 高度定制你的terminal</a></p>
<h1 id="Cocoapods"><a href="#Cocoapods" class="headerlink" title="Cocoapods"></a>Cocoapods</h1><p><a href="https://cocoapods.org" target="_blank" rel="external">xcode插件管理工具</a><br>我直接用homebrew安装了cocoapods<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">brew </span><span class="keyword">install </span>cocoapods</div></pre></td></tr></table></figure></p>
<p>默认安装到了 <code>/usr/local/Cellar/cocoapods/1.2.0</code> 这里的1.2.0是我当前版本号</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;这里介绍了一些好用的插件 与 开发环境的配置。如果我发现还有什么好玩的会接着更新.&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="MAC" scheme="http://vrast.cn/categories/MAC/"/>
    
    
      <category term="MAC" scheme="http://vrast.cn/tags/MAC/"/>
    
  </entry>
  
  <entry>
    <title>告别2016</title>
    <link href="http://vrast.cn/posts/fe76973f/"/>
    <id>http://vrast.cn/posts/fe76973f/</id>
    <published>2016-12-31T06:56:05.000Z</published>
    <updated>2016-12-31T08:03:26.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>2016年的最后一天，总想写点什么来记录下。📝  2016 有未来得及做完成的事情，也有遗憾的事。</p>
</blockquote>
<a id="more"></a>
<h1 id="我的2016"><a href="#我的2016" class="headerlink" title="我的2016"></a>我的2016</h1><p>2015年来现在这家公司,转眼也一年过去了，整整又是一年，到现在甚至有种生活步入正轨的错觉，其实真实的情况是该吃吃该喝喝，该开玩笑的时候绝对不假正经。这样也好 也不好。好在没什么人事之间的矛盾，不好在久而久之就像那温水里的青蛙。原因是外面的形势也不好。谁也不知道未来的手游圈还不好好混。</p>
<p>2016.10月4日，完成了人生中第一件大事，古人云：成家立业。那意思就是先要结婚成家然后才能明白自己要努力干出一番事业。爱人 家庭 是我前进的动力。目标是要有的，然后就是不顾一切的去实现他了。我老婆前一段认真的说道：”如果30岁之前买不起上海的房，那就跟我去重庆!”。我把这句话记在这里，在我30岁以前肯定会给你买套大房子😄  </p>
<p>2016.11月参加了国家成人高考，如愿进入上外。The Limits Of Your Language Are The Limits Of Your World . </p>
<p>还有什么事呢，我还真想不到了。应该都是一些不重要的事吧。值得记录下来的东西还真是不多。</p>
<h1 id="学会了什么"><a href="#学会了什么" class="headerlink" title="学会了什么"></a>学会了什么</h1><p>我看到过一个笑话是这样讲的，我完成了去年实现的所有目标，就是最后爱吹牛的毛病没有改掉。我的2016没有什么很具体的学习到的东西，还是在积累中。远未达到量变促成质变的境地。换句话说：我走在我的路上了。</p>
<h1 id="得到了什么"><a href="#得到了什么" class="headerlink" title="得到了什么"></a>得到了什么</h1><p>经历这一年的时间，明确了我应该达到的3年目标,8年目标。另外别人拥有的并非就是自己追求的东西，我亦不会羡慕。活成自己是我对自己2017年的要求。</p>
<h1 id="有什么遗憾"><a href="#有什么遗憾" class="headerlink" title="有什么遗憾"></a>有什么遗憾</h1><pre><code>惫懒的习惯浪费了2016年的大半美好时光。明明可以做一些有意义的事。最后一无所获。
</code></pre><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>总体上来看，2013 - 2014 - 2015 - 2016 四年里，兜兜转转还是最后找到自己今后要走的路。时间一去不复返，在这里立下2017年的目标</p>
<ul>
<li>2017年 有一个好作息习惯 晚上11:30 之前睡觉 早7:30之前起来</li>
<li>2017年 词汇过2w</li>
<li>做个独立开发者 </li>
<li>坚持学习</li>
<li>坚持写博客</li>
<li>拒绝慵懒</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;2016年的最后一天，总想写点什么来记录下。📝  2016 有未来得及做完成的事情，也有遗憾的事。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="生活" scheme="http://vrast.cn/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="None" scheme="http://vrast.cn/tags/None/"/>
    
  </entry>
  
  <entry>
    <title>使用Terminal写Hexo</title>
    <link href="http://vrast.cn/posts/a02a67d7/"/>
    <id>http://vrast.cn/posts/a02a67d7/</id>
    <published>2016-12-31T02:39:52.000Z</published>
    <updated>2016-12-31T06:58:27.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>之前写博文都是用Terminal命令生成md,文件然后通过sublimetext编辑文章,昨天偶见同事用VIM编辑代码十分的6,惊为天人,随后便有了这一篇记录博文。</p>
</blockquote>
<a id="more"></a>
<p><img src="/uploads/QQ20161231-0@2x.jpg" alt="iTerm2 + ZSH + solarized themes + vim"></p>
<blockquote>
<p>本文写的比较入门仅介绍写markdown所需要的一些基本快捷键,熟练之后基本上可以用vim全程写文。</p>
</blockquote>
<h1 id="Terminal常用快捷键"><a href="#Terminal常用快捷键" class="headerlink" title="Terminal常用快捷键"></a>Terminal常用快捷键</h1><ul>
<li>Conrol + A/E 在Console状态下移到行首与行末</li>
<li>Ctrl + u 清除当前行</li>
<li>Ctrl + k 清除当前至行末</li>
<li>Ctrl + l == Clear == 清屏</li>
</ul>
<h1 id="Vim常用快捷键"><a href="#Vim常用快捷键" class="headerlink" title="Vim常用快捷键"></a>Vim常用快捷键</h1><h2 id="Normal状态下的文本编辑"><a href="#Normal状态下的文本编辑" class="headerlink" title="Normal状态下的文本编辑"></a>Normal状态下的文本编辑</h2><h3 id="光标的转跳"><a href="#光标的转跳" class="headerlink" title="光标的转跳"></a>光标的转跳</h3><ol>
<li>G 至文末/gg 到文首</li>
<li>$/^ 光标移动到行尾/行首</li>
<li>Shift + 上下/左右 上下翻页,左右移动光标<br>3.1 w/b 前/后 移动光标(同上)</li>
<li>h/j/k/l 左／下/上／右移动光标</li>
</ol>
<h3 id="格式缩进"><a href="#格式缩进" class="headerlink" title="格式缩进"></a>格式缩进</h3><ol>
<li>Shift + &gt;/&lt; 右/左缩进</li>
</ol>
<h3 id="关于Copy-Paste-Undo-Delete"><a href="#关于Copy-Paste-Undo-Delete" class="headerlink" title="关于Copy/Paste/Undo/Delete"></a>关于Copy/Paste/Undo/Delete</h3><ol>
<li>v行选中/Ctrl+v列选中</li>
<li>y/yy 复制当前/复制整行</li>
<li>p 粘贴</li>
<li>u 撤销 /  Ctrl + r 反撤销 </li>
<li>d/dd 删除当前/删除整行(存剪切板)</li>
</ol>
<h3 id="Search"><a href="#Search" class="headerlink" title="Search"></a>Search</h3><ol>
<li>在当前文档中搜索光标所在</li>
<li>使用/ + 关键词搜索，使用n/N 后/前搜索</li>
</ol>
<h3 id="其他操作"><a href="#其他操作" class="headerlink" title="其他操作"></a>其他操作</h3><ol>
<li>j/J 移动到下一行/合并当前与下一行(移除换行符)</li>
</ol>
<h2 id="从Normal状态-进入编辑状态"><a href="#从Normal状态-进入编辑状态" class="headerlink" title="从Normal状态 进入编辑状态"></a>从Normal状态 进入编辑状态</h2><ol>
<li>s替换当前光标所在字符进入编辑</li>
<li>i插入到光标所在字符之前进入编辑</li>
</ol>
<h1 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h1><ol>
<li><a href="http://www.cnblogs.com/jiqingwu/archive/2012/06/14/vim_notes.html#commentform" target="_blank" rel="external">Vim使用笔记 - 博客园</a> </li>
<li><a href="http://python-web-guide.readthedocs.io/zh/latest/devtools/vim.html" target="_blank" rel="external">vim 快速入门</a></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;之前写博文都是用Terminal命令生成md,文件然后通过sublimetext编辑文章,昨天偶见同事用VIM编辑代码十分的6,惊为天人,随后便有了这一篇记录博文。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Terminal" scheme="http://vrast.cn/categories/Terminal/"/>
    
    
      <category term="VIM" scheme="http://vrast.cn/tags/VIM/"/>
    
  </entry>
  
  <entry>
    <title>AB热更新脚本信息无法获取(勘误)</title>
    <link href="http://vrast.cn/posts/fec7c50a/"/>
    <id>http://vrast.cn/posts/fec7c50a/</id>
    <published>2016-12-21T03:19:24.000Z</published>
    <updated>2016-12-22T06:02:33.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>今天遇到一个问题，热更新 Unity3D Prefab ，prefab上的附加脚本信息丢失(5.X API)，然后引发出了有趣的小故事～</p>
</blockquote>
<a id="more"></a>
<h1 id="BuildPipeline-BuildAssetBundles-Build包之后-加载的prefab上脚本丢失？"><a href="#BuildPipeline-BuildAssetBundles-Build包之后-加载的prefab上脚本丢失？" class="headerlink" title="BuildPipeline.BuildAssetBundles  Build包之后  加载的prefab上脚本丢失？"></a>BuildPipeline.BuildAssetBundles  Build包之后  加载的prefab上脚本丢失？</h1><p><img src="/uploads/QQ20161221-3@2x.jpg" alt="案例 Prefab"></p>
<p><img src="/uploads/BED55101-4E2C-472D-B09E-973776B3EB9D.jpg" alt="案例 打包脚本"></p>
<blockquote>
<p>manifest 文件上有脚本的关联信息，猜测是因为 改变了脚本的状态 导致找不到脚本。(一个错误的猜测)</p>
</blockquote>
<h1 id="测试-一个错误的测试"><a href="#测试-一个错误的测试" class="headerlink" title="测试(一个错误的测试)"></a>测试(一个错误的测试)</h1><ul>
<li>就是打包一个不暴露变量的脚本上去，看看获取ab包的时候能否自动找到本地的脚本<br><img src="/uploads/AF401BA4-BFE3-40AC-9A8C-CC007537AF75.jpg" alt="打包结果"><br>manifest 文件上 是可以找到两个脚本对应的guid。这里是对应的上的，但是get ab包的时候仍然找不到脚本 ？？</li>
</ul>
<h1 id="勘误"><a href="#勘误" class="headerlink" title="勘误"></a>勘误</h1><p>今天晚上重新看了这个问题，发现是由于打包的时候<code>重名文件引起的！</code>这里直接推翻了之前所有的猜测。</p>
<h1 id="勘误测试"><a href="#勘误测试" class="headerlink" title="勘误测试"></a>勘误测试</h1><p><img src="/uploads/QQ20161221-1@2x.jpg" alt="文件结构"></p>
<p>打包代码如下</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> UnityEditor;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ABBuilder</span> : <span class="title">Editor</span></div><div class="line">&#123;</div><div class="line">	[MenuItem(<span class="string">"Editor/导出ab"</span>)]</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">BudidCurrent</span>(<span class="params"></span>)</span></div><div class="line">	&#123;</div><div class="line">		BuildPipeline.BuildAssetBundles(<span class="string">"Assets"</span>, BuildAssetBundleOptions.None, BuildTarget.iOS);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>附加在prefab之上的测试脚本，本测试目的是测试 testStr 的debug输出是否正常。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> showLog : MonoBehaviour</div><div class="line">&#123;</div><div class="line">	<span class="keyword">public</span> <span class="built_in">string</span> testStr = <span class="string">"xiaonian"</span>;</div><div class="line">	<span class="comment">// Use this for initialization</span></div><div class="line">	<span class="function">IEnumerator <span class="title">Start</span><span class="params">()</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">while</span> (<span class="literal">true</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="function">yield <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">WaitForSeconds</span><span class="params">(<span class="number">1f</span>)</span></span>;</div><div class="line">			Debug.Log(testStr);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">// Update is called once per frame</span></div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">()</span></span></div><div class="line">	&#123;</div><div class="line"></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>AssetBundle的加载如下</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> UnityEngine;</div><div class="line"><span class="keyword">using</span> System.Collections;</div><div class="line"><span class="keyword">using</span> System.IO;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AB</span> : <span class="title">MonoBehaviour</span></div><div class="line">&#123;</div><div class="line">	<span class="function">IEnumerator <span class="title">Start</span>(<span class="params"></span>)</span></div><div class="line">	&#123;</div><div class="line">		<span class="function"><span class="keyword">yield</span> return new <span class="title">WaitForSeconds</span>(<span class="params"><span class="number">2</span></span>)</span>;</div><div class="line">		LoadAB();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LoadAB</span>(<span class="params"></span>)</span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">var</span> bts = File.ReadAllBytes((Application.dataPath + <span class="string">"/testkeyle"</span>));</div><div class="line"></div><div class="line">		<span class="keyword">var</span> ab = AssetBundle.LoadFromMemory(bts);</div><div class="line">		<span class="keyword">var</span> obj = ab.LoadAsset&lt;GameObject&gt;(<span class="string">"Cube"</span>);</div><div class="line">		Instantiate(obj);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="/uploads/QQ20161221-2@2x.jpg" alt="测试结果 正常输出"></p>
<h1 id="用这段代码演示这个错误的判断"><a href="#用这段代码演示这个错误的判断" class="headerlink" title="用这段代码演示这个错误的判断"></a>用这段代码演示这个错误的判断</h1><p><img src="/uploads/QQ20161221-0@2x.jpg" alt="文件结构"><br><img src="/uploads/QQ20161221-4@2x.jpg" alt="生成的manifest信息"><br><img src="/uploads/QQ20161221-3@2x.jpg" alt="测试结果 加载了重名的空预制体"></p>
<h2 id="这里可以猜想-是否Unity3d是遍历生成的信息-找到一个-同名的然后就return出去了-？"><a href="#这里可以猜想-是否Unity3d是遍历生成的信息-找到一个-同名的然后就return出去了-？" class="headerlink" title="这里可以猜想 是否Unity3d是遍历生成的信息 找到一个 同名的然后就return出去了 ？"></a>这里可以猜想 是否Unity3d是遍历生成的信息 找到一个 同名的然后就return出去了 ？</h2><p><img src="/uploads/QQ20161221-5@2x.jpg" alt="将A文件夹换到最后"><br>这里需要将原来生成的AB包相关信息全部删除，否则只会更新 manifest 文件 ！<br><img src="/uploads/QQ20161221-6@2x.jpg" alt="重新生成的manifest信息与AB包"><br><img src="/uploads/QQ20161221-7@2x.jpg" alt="测试结果 正常的预制体"></p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>如果AB包中存在重名的文件 AssetBundle 在加载的时候会顺序查找当前AB包中的文件 找到第一个同名资源就会返回该资源！</p>
<h1 id="就这样结束了吗-新的问题！伴随着解决旧问题-又被发现了-！"><a href="#就这样结束了吗-新的问题！伴随着解决旧问题-又被发现了-！" class="headerlink" title="就这样结束了吗  新的问题！伴随着解决旧问题 又被发现了 ！"></a>就这样结束了吗  新的问题！伴随着解决旧问题 又被发现了 ！</h1><h2 id="too-young-too-native"><a href="#too-young-too-native" class="headerlink" title="too young too native"></a>too young too native</h2><h1 id="又是一个演示"><a href="#又是一个演示" class="headerlink" title="又是一个演示"></a>又是一个演示</h1><p>我在主场景手动拖放了一个Cube，然后通过AB加载除了一个新的 Cube(Clone)</p>
<p><img src="/uploads/5CCE21BA-FEF8-4333-8C76-1D9F89D395B1.jpg" alt="新的问题~"></p>
<p>他俩的材质应该是一样的！但是此处显示居然不一致。通过AB加载出来的prefab材质 拖动数值居然不能改变显示效果。</p>
<h2 id="这个问题我还在查"><a href="#这个问题我还在查" class="headerlink" title="这个问题我还在查"></a>这个问题我还在查</h2><p>现在打包到真机看看结果<br><img src="/uploads/QQ20161222-0@2x.jpg" alt="新的问题~"></p>
<h2 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h2><p>发布到真机发现一切正常 ！<br><img src="/uploads/702E9B339B6CEA87BB44ACA6FBABCD56.jpg" alt="我做了一些代码上的修改 然后打包到真机环境"></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;今天遇到一个问题，热更新 Unity3D Prefab ，prefab上的附加脚本信息丢失(5.X API)，然后引发出了有趣的小故事～&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="UNITY3D" scheme="http://vrast.cn/categories/UNITY3D/"/>
    
    
      <category term="AssetBundle" scheme="http://vrast.cn/tags/AssetBundle/"/>
    
  </entry>
  
  <entry>
    <title>UNITY3D中的宏定义</title>
    <link href="http://vrast.cn/posts/e5d2512b/"/>
    <id>http://vrast.cn/posts/e5d2512b/</id>
    <published>2016-12-08T15:11:24.000Z</published>
    <updated>2016-12-08T15:44:56.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>本文介绍UNITY3D常用的宏命令以及如何定义一个宏。</p>
</blockquote>
<a id="more"></a>
<h1 id="常用的平台"><a href="#常用的平台" class="headerlink" title="常用的平台"></a>常用的平台</h1><p><img src="/uploads/8E256D56-9F58-43AA-B6F4-C2598A06B243.jpg" alt="常用的平台"></p>
<h1 id="定义宏"><a href="#定义宏" class="headerlink" title="定义宏"></a>定义宏</h1><h2 id="添加预编译指令-宏"><a href="#添加预编译指令-宏" class="headerlink" title="添加预编译指令(宏)"></a>添加预编译指令(宏)</h2><p>添加一个名为Test的宏 此时这段代码是无法执行的<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span></div><div class="line">&#123;</div><div class="line">    <span class="meta">#<span class="meta-keyword">if</span> Test</span></div><div class="line">    <span class="comment">//.. you code here</span></div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="使定义的宏可用"><a href="#使定义的宏可用" class="headerlink" title="使定义的宏可用"></a>使定义的宏可用</h2><p>找到 <code>Build Setting &gt; PlayerSetting &gt;当前平台 &gt; Scripting Define Symbols </code> 添加 Test 即可。</p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="https://docs.unity3d.com/Manual/PlatformDependentCompilation.html" target="_blank" rel="external">UNITY3D 官方文档</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文介绍UNITY3D常用的宏命令以及如何定义一个宏。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="UNITY3D" scheme="http://vrast.cn/categories/UNITY3D/"/>
    
    
      <category term="Define" scheme="http://vrast.cn/tags/Define/"/>
    
  </entry>
  
</feed>
